import{d as e,r as a,s,q as t,z as l,v as r,o,c as n,w as c,a as u,u as d,J as i,K as p,L as h,g as m,l as f,H as v,E as k,F as C,j as g,k as x,t as _,b as I}from"./index-USJ8ZV9j.js";import{S as b}from"./index.CgyAxIMo.js";import{N as S}from"./index.C1k3bsgS.js";import{U as j}from"./index.BqHB4PFf.js";import{E as L}from"./index.JSzYW5P7.js";import{I as U}from"./index.D7EZ4xV1.js";import{U as w}from"./index.DkTe9KrU.js";import{S as y}from"./index.CmC27huJ.js";import{_ as F}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./index.D-3UPTzE.js";const T=F(e({__name:"searchList",props:{checkedList:{}},emits:["checkboxChange","cancel"],setup(e,{emit:_}){const I=e,b=_,U=a([]),w=a(null),F=a(""),T=s((()=>{U.value=t.contactStore.contacts})),B=e=>{F.value=e},G=e=>{const a=e.detail.value;b("checkboxChange",a)},K=l((()=>F.value?U.value.filter((e=>t.appUserStore.getUserInfoFromStore(e.userId).name.includes(F.value))).map((e=>e.userId)):[])),q=()=>{b("cancel")};return r((()=>{T()})),(e,a)=>{const s=m,t=g,l=x,r=f;return o(),n(s,{class:"search-list-wrap"},{default:c((()=>[u(S,{onOnLeftTap:q},{left:c((()=>[u(s,{class:"input-wrap"},{default:c((()=>[u(y,{ref_key:"searchRef",ref:w,placeholder:d(v)("searchContact"),onInput:B,onCancel:q},null,8,["placeholder"])])),_:1})])),_:1}),K.value.length?(o(),n(s,{key:0,class:"search-content"},{default:c((()=>[u(r,{onChange:G},{default:c((()=>[(o(!0),i(h,null,p(U.value,(e=>k((o(),n(l,{class:"label"},{default:c((()=>[u(t,{class:"checkbox",backgroundColor:"#f9fafa",borderColor:"#ACB4B9",activeBackgroundColor:"#009DFF",activeBorderColor:"#009DFF",style:{transform:"scale(0.8)"},iconColor:"#fff",value:e.userId,checked:I.checkedList.includes(e.userId)},null,8,["value","checked"]),(o(),n(j,{key:e.conversationId,class:"search-item",user:{userId:e.userId}},null,8,["user"]))])),_:2},1536)),[[C,K.value.includes(e.userId)]]))),256))])),_:1})])),_:1})):(o(),n(L,{key:1}))])),_:1})}}}),[["__scopeId","data-v-eabf46c6"]]),B=F(e({__name:"index",setup(e){const l=a([]),i=a(!1),p=a([]);s((()=>{l.value=t.contactStore.contacts.map((e=>({...e,...t.appUserStore.getUserInfoFromStore(e.userId),id:e.userId})))}));const h=e=>{p.value=e},f=()=>{if(!p.value.length)return;let e=p.value.map((e=>t.appUserStore.getUserInfoFromStore(e).name)).join("、");e=t.appUserStore.getSelfUserInfo().name+"、"+e;const a={groupname:e,members:p.value,desc:e,public:!0,allowinvites:!0,inviteNeedConfirm:!1,approval:!1,maxusers:1e3};uni.showLoading({title:"loading",mask:!0}),t.groupStore.createGroup({data:a}).then((e=>{var a;uni.redirectTo({url:`/ChatUIKIT/modules/Chat/index?type=groupChat&id=${null==(a=e.data)?void 0:a.groupid}`})})).finally((()=>{uni.hideLoading()}))},k=()=>{uni.switchTab({url:"/ChatUIKIT/modules/Conversation/index"})};return r((()=>{})),(e,a)=>{const s=m;return o(),n(s,{class:"group-create-wrap"},{default:c((()=>[i.value?(o(),n(T,{key:1,checkedList:p.value,onCheckboxChange:h,onCancel:a[1]||(a[1]=e=>i.value=!1)},null,8,["checkedList"])):(o(),n(s,{key:0},{default:c((()=>[u(S,{onOnLeftTap:k},{left:c((()=>[u(s,{class:"title",textContent:_(d(v)("createGroup"))},null,8,["textContent"])])),_:1}),u(s,{class:"search-wrap",onClick:a[0]||(a[0]=e=>i.value=!0)},{default:c((()=>[u(b,{placeholder:d(v)("searchContact")},null,8,["placeholder"])])),_:1}),l.value.length?(o(),n(U,{key:0,class:"contact-indexed-list",checkedList:p.value,options:l.value,withCheckbox:!0,onCheckboxChange:h},{indexedItem:c((e=>[u(j,{class:"contact-item",user:e.item},null,8,["user"])])),_:1},8,["checkedList","options"])):(o(),n(L,{key:1})),u(s,{class:"create-btn-wrap"},{default:c((()=>[u(w,{class:"crate-btn",disabled:!p.value.length,onClick:f},{default:c((()=>[I(_(d(v)("createGroupBtn")+"("+p.value.length+")"),1)])),_:1},8,["disabled"])])),_:1})])),_:1}))])),_:1})}}}),[["__scopeId","data-v-d77b3097"]]);export{B as default};
