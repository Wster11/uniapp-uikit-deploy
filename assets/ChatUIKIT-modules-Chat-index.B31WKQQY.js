import{d as A,r as e,Q as s,F as a,G as t,ad as l,o,a as n,c as i,w as r,b as u,u as c,e as g,t as d,M as p,j as m,L as v,aa as B,f as h,$ as I,a1 as f,a0 as C,X as w,Z as U,g as E,a9 as Q,a7 as y,a6 as R,ae as k,n as F,af as S,ag as b,ah as x,s as D,ac as V,ab as Y,ai as M,aj as K,ak as T,H as X,al as J,am as G,an as H,ao as O,ap as P,aq as W,ar as q,I as N,as as L,N as j,v as Z,O as z,z as _,at as $,au as AA,av as eA,aw as sA,ax as aA,ay as tA,R as lA,T as oA,V as nA,W as iA,Y as rA,az as uA,aA as cA}from"./index-BkrUuuud.js";import{A as gA}from"./index.CZ5ye3_-.js";import{N as dA}from"./index.D1vfVCH7.js";import{_ as pA}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{U as mA}from"./index.CAY8m-Ih.js";import{I as vA}from"./index.BYGzmpDq.js";import{o as BA}from"./uni-app.es.BU6RVY1G.js";const hA=pA(A({__name:"index",setup(A){const h=e({avatar:"",name:""}),I=s((()=>"singleChat"===h.value.conversationType)),f=a.getFeatureConfig(),C=t((()=>{const A=a.convStore.currConversation;if("singleChat"===(null==A?void 0:A.conversationType)){const e=a.appUserStore.getUserInfoFromStore(A.conversationId);h.value={name:null==e?void 0:e.name,id:A.conversationId,avatar:null==e?void 0:e.avatar,conversationType:A.conversationType,presenceExt:null==e?void 0:e.presenceExt,isOnline:null==e?void 0:e.isOnline}}else if("groupChat"===(null==A?void 0:A.conversationType)){const e=a.groupStore.getGroupInfoFromStore(A.conversationId);h.value={name:null==e?void 0:e.groupName,id:A.conversationId,avatar:a.groupStore.getGroupAvatar(A.conversationId),conversationType:A.conversationType}}})),w=()=>{p()};return l((()=>{f.usePresence&&I&&(a.appUserStore.getUsersPresenceFromServer({userIdList:[h.value.id]}),a.appUserStore.subscribePresence({userIdList:[h.value.id]}))})),o((()=>{f.usePresence&&I&&a.appUserStore.unsubscribePresence({userIdList:[h.value.id]}),C()})),(A,e)=>{const s=m;return n(),i(s,null,{default:r((()=>[u(dA,{onOnLeftTap:w},{left:r((()=>[u(s,{class:"left-content"},{default:r((()=>[u(gA,{size:32,src:h.value.avatar,placeholder:I.value?c(v):c(B),withPresence:!!I.value,presenceExt:h.value.presenceExt,isOnline:h.value.isOnline},null,8,["src","placeholder","withPresence","presenceExt","isOnline"]),u(s,{class:"name ellipsis"},{default:r((()=>[g(d(h.value.name),1)])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-ec81c15f"]]),IA=pA(A({__name:"messageTxt",props:{msg:{}},setup(A){const e=A,t=s((()=>Q(e.msg.msg))),l=e.msg.from===a.getChatConn().user||""===e.msg.from;return(A,s)=>{const a=y,o=m;return n(),i(o,{class:"msg-text"},{default:r((()=>[h("span",{class:"msg"},[(n(!0),I(f,null,C(t.value,((A,e)=>(n(),I("span",{class:w([{"emoji-wrap":"text"!==A.type}]),key:e},["text"===A.type?(n(),I("span",{key:0},d(A.value),1)):(n(),i(a,{key:1,class:"msg-emoji",src:A.value},null,8,["src"]))],2)))),128))]),e.msg.modifiedInfo?(n(),i(o,{key:0,class:w(["msg-edited-tag",{self:c(l)}])},{default:r((()=>[g(d(c(U)("messageEdited")),1)])),_:1},8,["class"])):E("",!0)])),_:1})}}}),[["__scopeId","data-v-0f6fa56b"]]),fA="/assets/img404-Cp8iTHlc.jpg",CA=225,wA=pA(A({__name:"messageImage",props:{msg:{},mode:{},width:{},height:{},disabledPreview:{type:Boolean}},setup(A){const s=A,a=e(!1),t=s.width?`${s.width}px`:"auto",l=s.height?`${s.height}px`:"225px",o=e({width:t,height:l}),g=s.mode||"aspectFit",d=()=>{a.value=!0,s.msg.thumb=fA},p=()=>{a.value||!0===s.disabledPreview||k({urls:[s.msg.url||""]})},v=A=>{s.width||s.height||(A=>{const{width:e,height:s}=A;if(0===e||0===s)return;let a=0,t=0;e>s?(a=CA,t=CA*s/e):(a=CA*e/s,t=CA),o.value.width=a+"px",o.value.height=t+"px"})(A.detail)};return(A,e)=>{const s=y,a=m;return n(),i(a,{class:"msg-image"},{default:r((()=>[u(s,{mode:c(g),style:R({width:o.value.width,height:o.value.height}),onError:d,onClick:p,onLoad:v,class:"image",src:A.msg.thumb},null,8,["mode","style","src"])])),_:1})}}}),[["__scopeId","data-v-720ee572"]]),UA=225,EA=pA(A({__name:"messageVideo",props:{msg:{},mode:{},width:{},height:{},disabledPreview:{type:Boolean}},setup(A){const s=A,a=s.width?`${s.width}px`:"auto",t=s.height?`${s.height}px`:"225px",l=e({width:s.width?s.width/2+"px":"64px",height:s.height?s.height/2+"px":"64px"}),o=e({width:a,height:t}),g=s.mode||"widthFix",d=e(!1),p=e(!1),v=()=>{s.msg.thumb=fA,d.value=!0},B=A=>{p.value=!0,s.width&&s.height||(A=>{const{width:e,height:s}=A;if(0===e||0===s)return;let a=0,t=0;e>s?(a=UA,t=UA*s/e):(a=UA*e/s,t=UA),o.value.width=a+"px",o.value.height=t+"px"})(A.detail)},h=()=>{!0!==s.disabledPreview&&F({url:`/ChatUIKIT/modules/VideoPreview/index?url=${s.msg.url}`})};return(A,e)=>{const s=y,a=m;return n(),i(a,{class:"msg-video"},{default:r((()=>[u(a,{class:"video-poster"},{default:r((()=>[u(s,{mode:c(g),style:R({width:o.value.width,height:o.value.height}),onError:v,onLoad:B,class:"image",src:A.msg.thumb},null,8,["mode","style","src"]),!d.value&&p.value?(n(),i(a,{key:0,style:R({width:l.value.width,height:l.value.height}),onClick:h,class:"video-play-btn"},{default:r((()=>[u(s,{class:"video-play-btn-image",src:c("data:image/png;base64,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")},null,8,["src"])])),_:1},8,["style"])):E("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-5bb0ff35"]]),QA=pA(A({__name:"messageAudio",props:{msg:{}},setup(A){const s=a.getChatConn(),t=A,l=new Map,p=e(!1),v=a.messageStore.checkMessageFromIsSelf(t.msg),B=a.messageStore,h=async()=>{if(!E()){const A=b();l.set("audio",A),f(),A.src=await I()}C()},I=()=>new Promise(((A,e)=>{const{url:a}=t.msg;x({url:a||"",header:{"X-Requested-With":"XMLHttpRequest",Accept:"audio/mp3",Authorization:"Bearer "+s.token},success:e=>{const s=e.tempFilePath;A(s)},fail:A=>{console.warn("downloadFile failed",A),e(A),D({title:"语音转mp3失败",duration:2e3})}})})),f=()=>{const A=E();A&&(p.value=!1,A.onPlay((()=>{p.value=!0})),A.onStop((()=>{p.value=!1})),A.onPause((()=>{p.value=!1})),A.onError((A=>{p.value=!1,console.warn("audio play error",A)})),A.onEnded((()=>{p.value=!1})))},C=()=>{p.value?U():(B.setPlayingAudioMessageId(t.msg.id),w())},w=()=>{var A;null==(A=E())||A.play()},U=()=>{var A;null==(A=E())||A.stop()},E=()=>l.get("audio");return S((()=>B.playingAudioMsgId),(A=>{A!==t.msg.id&&(U(),p.value=!1)})),o((()=>{var A;const e=E();p.value&&U(),null==(A=null==e?void 0:e.destroy)||A.call(e),l.delete("audio")})),(A,e)=>{const s=m,a=y;return n(),i(s,{class:"msg-audio"},{default:r((()=>[u(s,{class:"content-wrap",onClick:h},{default:r((()=>[c(v)?(n(),i(s,{key:0,class:"content",style:R({width:10*(t.msg.length||0)+"px"})},{default:r((()=>[u(s,null,{default:r((()=>[g(d(t.msg.length)+"'' ",1)])),_:1}),u(a,{class:"image",src:p.value?c("data:image/gif;base64,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"):c("data:image/png;base64,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"),mode:"aspectFit"},null,8,["src"])])),_:1},8,["style"])):(n(),i(s,{key:1,class:"content",style:R({width:5*(t.msg.length||0)+"px"})},{default:r((()=>[u(a,{class:"image",src:p.value?c("data:image/gif;base64,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"):c("data:image/png;base64,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"),mode:"aspectFit"},null,8,["src"]),u(s,null,{default:r((()=>[g(d(t.msg.length)+"''",1)])),_:1})])),_:1},8,["style"]))])),_:1})])),_:1})}}}),[["__scopeId","data-v-2c8dcfff"]]),yA=pA(A({__name:"messageFile",props:{msg:{}},setup(A){const e=A,s=a.messageStore.checkMessageFromIsSelf(e.msg),t=(e.msg.file_length/1024).toFixed(2)+"kb",l=()=>{};return(A,a)=>{const o=m;return n(),i(o,{class:w(["msg-file",{isSelf:c(s)}]),onClick:l},{default:r((()=>[u(o,{class:"left"}),u(o,{class:"right"},{default:r((()=>[u(o,{class:"file-name ellipsis"},{default:r((()=>[g(d(e.msg.filename),1)])),_:1}),u(o,{class:"file-size"},{default:r((()=>[g(d(t))])),_:1})])),_:1})])),_:1},8,["class"])}}}),[["__scopeId","data-v-04bb976f"]]),RA=pA(A({__name:"messageUserCard",props:{msg:{}},setup(A){const e=A,t=a.messageStore.checkMessageFromIsSelf(e.msg),l=s((()=>{const A=a.appUserStore.getUserInfoFromStore(e.msg.customExts.uid);return{nickname:(null==A?void 0:A.nickname)||e.msg.customExts.nickname,avatar:(null==A?void 0:A.avatar)||e.msg.customExts.avatar}}));return(A,e)=>{const s=m;return n(),i(s,{class:"msg-user-card-wrap"},{default:r((()=>[u(s,{class:w(["msg-user-card",{isSelf:c(t)}])},{default:r((()=>[u(gA,{size:44,src:l.value.avatar,placeholder:c(v)},null,8,["src","placeholder"]),u(s,{class:"user-name"},{default:r((()=>[g(d(l.value.nickname),1)])),_:1})])),_:1},8,["class"]),u(s,{class:"tag"},{default:r((()=>[g(d(c(U)("contact")),1)])),_:1})])),_:1})}}}),[["__scopeId","data-v-c0f48a68"]]),kA=pA(A({__name:"messageQuote",props:{msgId:{},isReplying:{type:Boolean},messageQuoteExt:{},titleStyle:{}},emits:["jumpToMessage"],setup(A,{emit:l}){const p=A,v=e(null),B=e(null),k=l,F=()=>{B.value&&k("jumpToMessage",B.value.id)},S=s((()=>B.value?Q(Y(B.value)):Q(U("messageNotFound")))),b=t((()=>{var A;if(p.msgId){if(B.value=V(a.messageStore.messageMap.get(p.msgId))||null,!B.value)return void(v.value={nickname:p.messageQuoteExt.msgSender});v.value=a.appUserStore.getUserInfoFromStore(B.value.from)}else{if(B.value=V(null==(A=a.messageStore)?void 0:A.quoteMessage)||null,!B.value)return;v.value=a.appUserStore.getUserInfoFromStore(B.value.from)}})),x=U("you"),D=U("reply");return o((()=>{b()})),(A,e)=>{const s=m,a=y;return n(),i(s,{class:"msg-quote-wrap"},{default:r((()=>[u(s,{class:"quote-brief",onClick:F},{default:r((()=>[u(s,{class:"title",style:R(A.titleStyle?A.titleStyle:{})},{default:r((()=>[p.isReplying?(n(),i(s,{key:0,class:"user",textContent:d(c(x))},null,8,["textContent"])):E("",!0),p.isReplying?(n(),i(s,{key:1,class:"tip",textContent:d(c(D))},null,8,["textContent"])):E("",!0),v.value?(n(),i(s,{key:2,class:"user"},{default:r((()=>[g(d(v.value.nickname),1)])),_:1})):E("",!0)])),_:1},8,["style"]),u(s,{class:"content"},{default:r((()=>[h("span",{class:"msg ellipsis"},[(n(!0),I(f,null,C(S.value,((A,e)=>(n(),I("span",{class:w([{"emoji-wrap":"text"!==A.type}]),key:e},["text"===A.type?(n(),I("span",{key:0},d(A.value),1)):(n(),i(a,{key:1,class:"msg-emoji",src:A.value},null,8,["src"]))],2)))),128))])])),_:1})])),_:1}),B.value?(n(),i(s,{key:0,class:"quote-msg"},{default:r((()=>["img"===B.value.type?(n(),i(wA,{key:0,msg:B.value,mode:"scaleToFill",width:40,height:40,disabledPreview:p.isReplying},null,8,["msg","disabledPreview"])):"video"===B.value.type?(n(),i(EA,{key:1,msg:B.value,mode:"scaleToFill",width:40,height:40,disabledPreview:p.isReplying},null,8,["msg","disabledPreview"])):E("",!0)])),_:1})):E("",!0)])),_:1})}}}),[["__scopeId","data-v-2b919480"]]),FA=pA(A({__name:"messageActions",props:{msg:{},isSelected:{type:Boolean}},setup(A,{expose:t}){const o=A,p=e(!1),v=e(""),B=e(0),h=e("0px"),k=e([]),F=e({width:0,height:0}),S=a.messageStore.checkMessageFromIsSelf(o.msg);l((()=>{M({success:A=>{F.value={width:A.windowWidth,height:A.windowHeight}}})}));const b=s((()=>"overstep"===v.value?{top:`${B.value}px`,right:0}:"")),x=s((()=>"nearTop"===v.value?S?"right-up-box":"left-up-box":"nearBottom"===v.value?S?"right-down-box":"left-down-box":""));const D=()=>{const A=Q(o.msg.msg).reduce(((A,e)=>A+("text"===e.type?e.value:e.alt)),"");X({data:A,success:()=>{p.value=!1}})},V=()=>{a.messageStore.setQuoteMessage(o.msg),p.value=!1},Y=()=>{a.messageStore.setEditingMessage(o.msg),p.value=!1},J=()=>{a.messageStore.deleteMessage({conversationType:o.msg.chatType,conversationId:a.convStore.getCvsIdFromMessage(o.msg)},o.msg.id)},G=()=>{a.messageStore.recallMessage({mid:o.msg.id,to:a.convStore.getCvsIdFromMessage(o.msg),chatType:o.msg.chatType}),p.value=!1};return t({handleLongPress:function(A,e){let s=A.changedTouches[0].clientY;T().in(e).select(`#msg-bubble-${o.msg.id}`).boundingClientRect((A=>{h.value="8px",A.top>180?v.value="nearBottom":A.height>F.value.height/2?(A.top<0?B.value=-A.top+s:B.value=s-A.top,v.value="overstep"):v.value="nearTop"})).exec(),(()=>{const A=[],e=Date.now()-o.msg.time<1e4,s=S&&"txt"===o.msg.type&&"failed"!==o.msg.status&&"sending"!==o.msg.status,t="failed"!==o.msg.status&&"sending"!==o.msg.status,l=a.getFeatureConfig();l.copyMessage&&"txt"===o.msg.type&&A.push({label:U("copyBtn"),icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGYSURBVHgB7ZoxS8NAFMdf1C3O9RsoIuKm4CYiDiIiaLFgoaCDIjj5AXRy0EkQXQShgqUKouAgIn4H0VVd2w52SKYMNq9D6JBL7/JCXlPeb0p7PZpf7n/vkiPWvw9kmAHIOCLAjQhwMwREXt/e4eLqGlzXhbjYtg2ry0tQLOTBFPIIlCt3pJNHsP9NpQrl2yqYQhao1euQFHEkyBHq5OXxHkxx/Kt/6UcQo4igBKIbJ/ZJPOzn/2B/Dxbm54LvTEaiZ6pQXAlLdS/EVV1Oz86DOCGbG/nI/oOHPmENR8cn8NdsAgXP8+Dj86t9PDU5odVndmYaao0GfP/8tj9jf4zZ+Nho6O+VEeKsLmFxUpHaHDCV2NkqBcdORIxTncQmEhgbHVKvQnFXXBUsZTRJCbZ1ACUenp6BCutCFlVddGEVcIh3sYg8kXEjAtyIADciwI0IcCMC3MjmLpXFlTWgkIkRGMnllG09L4CbY8XCurKdPUJxNoQ7kSrETf8K2Jo7YxSiqosuSoHd7VIif6CiW3XRxZJ3JZgRAW5a3gOTBPp7V3kAAAAASUVORK5CYII=",action:D}),l.editMessage&&s&&A.push({label:U("editBtn"),icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMESURBVHgB7Zq9btNQFMfPsUMlmPIIRiAB6hKegHRpOzUWZWAjb0BXpiYbG/QNyoZEQaYsEAbCxpipgqFSeIOygBCJD+c0CbROYl+nvtdX6f0tsRwf3/v/3w/fLwCHw+FwOC4tCEtGGIbVX8NKU67Rr0Tvo5f9tOeXyoDNMAzi2P/El8H4Vv+aN7wbRdHJvBgPloQZ4oVgUhvmUYEF+VfVPLoHBDUoAALgkqKoc/imnSdujvhT0I9P0mIXMmAj3H78M4YWIFUl18WCtfWtB9g5PGipPJ0qHqEPsNJNi8/dBNa37u9SDM/5sgraoEcqT2WJR7yyltUJ5jJASp5f3QLNcOa7Wc8UIV5QNkAS5JLfAc2MM9/OyksR4gXlPmA49Or88mAqQYA99DDiV/WhALIyXqR4QdkA9PwGcBVIJLj/4e1r7bViQtHiBfU+gCiYThRfgCF0iBdydII0o9cvptpnoUu8YP1IUKd4wWoDdIsXrDXAhHjBSgNMiResM8CkeMEqA0yLF6wxoAzxwsLrAUVyUfGn8xTynxFJfL71hNJrQBElL/EsPuTLmsxWeT2hBYqUakAR4uUd0/Fq6wlCaQaU1eaTlGKALeIF4wbYJF4waoBt4gVjBtgoXjBigK3iBe0G2Cxe0GqA7eIFrQbYLl7QZkCd9w7BcvGCNgO6siWNcG5j0jbxgtYmQOitjTYoBezZJl7QOh3+GL3q8c/1zfBhYJvwCUbGAbaKF5bmhMiiOAPgknNBAwYBlE4lSN7BxOc3DXUD0Oslb1EcN6BkiGYsfxF8B0XUzwcgfR4vPJ5JB3c2GtvV0Ta5mZ3i/wx4nhE3OE/N5D/oUQSKKBvwGwb7K+jvsupz2+SSAS6FJsAfMM/0OU+Vk2FnUW4CMrTlks51fq8UYtzLM+7wIQfHX4++3Li1KrbXwUqw3Xl38DRPRC4DhONvR92bd1Z/sAu3QetZwRxwr4+ET/KKH4UuyGhDwqvH5POXgAIkMmoGIfKnDvvSOV/l/intQLTD4XA4HA6HwzHNXwIQqCZbI0x/AAAAAElFTkSuQmCC",action:Y}),l.replyMessage&&t&&A.push({label:U("replyBtn"),icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANRSURBVHgB7ZpBTxNBFMff261GPfXosSiRoAfLzRvtgcIFXKiewU8gfgLgE4ifoPVmAoUtJAbKgV49wY1ooqnfoF4UNJ1xngVFguzM7sx0N84vIXTTnd28f2ff/N+bBXA4HA6Hw+FwOBz/Iz5YZCoICndHHtSGR+7f/vj+6B2kAARLUPCM+fviY4GOPe/a0E74pgMDJgcWmAieFhljFHweUoYHhqHgMaXBE0YFqMxW59McPGHsEaDgoQd1SDlGZkBlZm4pC8ET2gX4FTzgMmQErQJkLXhCmwBZDJ7QkgQnH1drnMMCZJDEMyDLwROxrXAQBPlv3N8UwZcgBojQPv3YBY4d4PDZ97H9Nlw7BIvEEoCC/9r39UXQT5fEYYw397Y36mAYZQFOi5pNMBP8RTokBuK1FVOFk5IAFys6myDwVfSuv9IthHQ/YJDB98FHnLPgzr3RL58+HGnLE1ICDD743+QRMRgeGc2LhsouaCDyETgN/gDSV9Ed3vJ65TAMu5CASB/AWI4SXhrL2aJYiQ5oRYIESBghbiPbx6VAy3ESESIFOGdY0kpRGLKXEJPoRwC9F0KEDqQYsuKT03OLEAMpH0CJkHN/X9yoAOmlKzrNY6o+QaoY2glD4ch65ZTPhDznP2qgiHQ1mAURqDCrTFcDlTFK5XAmZgKCUkJU7geQCCfYGxM3slq2KlCYCp6UZE+O1RBpC/f1XcyERCIgHgpb2z77o2NxvUSu7gzO+ZLsuYn3Bisz1br4Nw+K/GtvkEzNMeSKXKzvnOO4WIhLolmibHRk9x61bI5OzFRXxYWeq4xR2RytBCKxcW8eRDUI0uBKa2t9OeosLV3hva3GIt0QDNEKG2GruTbreb0hcfhaZgwiH5c5T1tbvK+2OREISsCtrcaCjBC0JMrUCFo3RmyIQPwRgj+7akk+Ab8UdS3tW2O2RCB2wo36Vb6EseiOtZHNURKBfh2wwDlfEl7ydSFqvLH3A+jXsSUC+ZJWszELF/KCWEofRo01+oIEicA9b0yXwYmC8gL8LYLdJHgZe2Knh6NXtinCWRMHJe5pXACCRPDEc3o+Wd2AY2OC7DYbZZp5Nyk3RGDtNTmi31jJ1YBBc3d7fRUcDofD4XA4HA7HoPgJCZVKFqyVXdQAAAAASUVORK5CYII=",action:V}),S&&(l.deleteMessage&&A.push({label:U("deleteBtn"),icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAM8SURBVHgB7Zq9bhNBEMdn9hxEh0vKK6CIaPwISZHIDeEUgkQJTxDeIE4HnfMEkA6Bhc5BQk6qo6MjFUqDdHkCnC6Q3Ax7CgjOWcd7I936ctlfkTh3O7Hn7/nYjwPweDyeGwyCQ7rRxhITPALktnEA4zhQuPspfn8IjnAmwOra+pZ+u57daO4d7H3YBgc4EWAletJBoq9lbJTC5VE8SKBiFLiA6BmUhIkjcIATAXSYtQVGd8ABLXCAUpwwI5exQeTP4PFUztQu0I2ikKm1ObVnXxf03AJVa2cUv01Nt40C5M4TBXnbut7O/2PcUmrZNMEydoGMghfQHOdz2hnTpumGUQBslvMXMJyYLhsFYKX6WoUxNAXtC6qFvvnWFC6KoE4Fw4REN/SO/tGBGoEIqf6VXLqhv/nc+VJFcBaraxs9/Z+3oFbg9sHeoAclcbMWqDFeABDATCnUDL3SEBXt6iMgr8AAO4AqtjZBTHKbP4XNCgIUCVDpajB3AHFheTS8qMAra4/72rHNGTZv9oeD5/lr3Yn6DHpGytXNS0QRgNZqY/p/+9Fhmsy0QNz9+3oUx6kWzGp/sBWQuxRQgSzcpHY2sDAFfBcAEecpNIRKI4CZw+KV2cKpiVDWW2lWBVA1JQUIgglH7DZkLtvZIRLgFJqzUhQJkMTxzRagBIXwzfv6LAPDsjUEC6Ytd2chF8Buw6T2O0tyAbgZdaApEyHxl1G5AN3oaThxKb1ieMGRpSiyTSH3ApRZqpag4MhtBzWkESmAWOMUcAO6F4AZjm3GKcgmwnj6h9V7AWnxSiuEiqk8AmhiLq/P/WvVPpuRAswnIESeAnVaECH8ACHyNmhZeDgrHqFdvb4vpkuWUQgVU/kzQoy8tfJwfRwEtxKiX3pHmKeeKerC2smfJ2ypYJjXDqLqj9/EAqCCMZPV0Lau7q+JzsDuKBJ750Q9KIGOKquOZEKcApRRraq5FL8rDA0AeQ5T4SBQKdQEmsdUOAOsTQ2QHovliAU4g7O0Ls8RMSxYnR+aCEBIenR0em/xwU/97l2YK7i9P3wXgxCxADnfj759ub+4eMygQv3nXXAKHiLjq4OPg5fg8Xg8Ho/HI+A3gD0J3Egv4eUAAAAASUVORK5CYII=",action:J}),l.recallMessage&&e&&A.push({label:U("recallBtn"),icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAOZSURBVHgB7ZrPTxNBFMffmxWCnHr0WDGREDXWvwB6ABsTcUFNuFn/AuUvoPwFyF8g3DTyY+EEeABu3ugJGxOx3DzCBUzaneebKglh+2OW7s5uw3wubWfa3b7vzLx5780CWCwWi8VisVhuJggp4Zn7Olf3ZVY4feUt71MVDCEgBUxMTs/VpTzg4ViXsrarxABDJC6AMp4nYulSU9YnuQCGSFSAJsZfkAFDJCZAG+MBkRbBEIkI0M54bp/f8taWwBDGd4FOxu9srpTAIEYFSJvxjbuCIdJofOPOYIC0Gt+4O8RMmo1v/AOIkfbGwwkieG0vQHgCBMfoQHkA6mXP804gYmITYPz5dBERP0KEsGBLfM3lLW9lDyIiNgEmJl8d8BDGFdOXheibiiJpii0Q4mgu8ul6iRwnTb/+LbHuiE0AiWKW51ecIoDyL09fvOxqmcXqBMc5rUWSu+zIMk3uzE5QlND3T1v9nhyRIUk5XvujRJBt9T3lG7Y3Vt/CNYh9G2wrAq/lQeHndbx7wZ0uEuFcayGotLO5Ng8hMRIIRSWCgp1riY1tuvaFwHzYHcJINvjV+1ImFPkWPiF3Jp1d13W1agAqcEKBs836pKTQ/sABQxxVDn8PjTzcRqAZ/jhwpftOjUTh0cjw50ql8qfTtX5WDr/dG36gZu/Yla7M0P2R46Mf38ugidF6QOQzAWHvajsvgzcQAuMFkShF4Kgw4PTYSY4V3JksaJJIRaiTCOfSKelcRzm8ZrOA/LoLmiRWE2wrAu/7mpfhEcf9QKOgx6BJolXhNiJoOzFWoMl3MQuaJH4ucCECT+Wq+szreu82+rO6v+dosRpoI8qCJrcgBSgR+OUuJEAqjsa6wQEK7Bg8i6qgSc8LQLxrBBvpFDTpfQEIAzsGAaYzEoyagutmgWRgzxciGBu0oqcFIHICWaHaTcJkhD0rgEqxOewtBjqIPAhBTwqgpj5KuR7oUFUm0R/qZLnnBFAjLzlh4rfZQCfhYthKcWqeEeqEyhDPpHjHf/k9QNMaY3lnY/UJhCQVkWArVFor/RoXRXH0TFIRWjw5ohwfYt8UXAPtGaBG4JycdZVvQ4r4b3z+uock2j6AjV9Im/Fq2ndjvEJbAI64jD26pgfOD6Kf7/Z4TNsHENA+Nou7TaK2OYJlFH0fonqYUluAmvBL/dJRTihU0bErGoUSrHIluYyS9geE9LyN6I/ILRaLxWKxWCyWG8hfU5pyPWzHJvcAAAAASUVORK5CYII=",action:G})),k.value=A})(),setTimeout((()=>{p.value=!0}),100)}}),(A,e)=>{const s=y,a=m;return p.value&&k.value.length?(n(),i(a,{key:0,class:w(["message-popup-box",x.value]),style:R("overstep"==v.value?b.value:{"--arrowPosition":h.value,right:c(S)?"0":"auto"})},{default:r((()=>[u(a,{class:"message-operate"},{default:r((()=>[(n(!0),I(f,null,C(k.value,((e,t)=>(n(),i(a,{class:"operate-item",key:t,onClick:K((s=>e.action(A.item,A.index)),["stop"])},{default:r((()=>[u(s,{src:e.icon,mode:"aspectFill",alt:"",class:"operate-item-icon"},null,8,["src"]),u(a,{class:"operate-item-txt"},{default:r((()=>[g(d(e.label),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1},8,["class","style"])):E("",!0)}}}),[["__scopeId","data-v-c74e15db"]]),SA=pA(A({__name:"messageStatus",props:{msg:{}},setup(A){const e=A;return(A,s)=>{const a=m;return n(),i(a,{class:"msg-status-wrap"},{default:r((()=>["sending"===e.msg.status?(n(),i(a,{key:0,class:"msg-status sending"})):"sent"===e.msg.status?(n(),i(a,{key:1,class:"msg-status sent"})):"failed"===e.msg.status?(n(),i(a,{key:2,class:"msg-status failed"})):"received"===e.msg.status?(n(),i(a,{key:3,class:"msg-status received"})):"read"===e.msg.status?(n(),i(a,{key:4,class:"msg-status read"})):E("",!0)])),_:1})}}}),[["__scopeId","data-v-889d1294"]]),bA=pA(A({__name:"messageItem",props:{msg:{},isSelected:{type:Boolean}},emits:["onLongPress","jumpToMessage"],setup(A,{emit:t}){var l;const o=A,p=t,B=A=>{p("jumpToMessage",A)},h=G(),I=e(null),f=a.appUserStore,C=A=>f.getUserInfoFromStore(A||"")||{},U=a.getFeatureConfig().messageStatus,Q=a.getChatConn().user===o.msg.from||""===o.msg.from,y=(null==(l=o.msg.ext)?void 0:l.ease_chat_uikit_user_info)||{},k=s((()=>{let A="msg-bubble";return"img"!==o.msg.type&&"video"!==o.msg.type&&(A=Q?"msg-bubble msg-bubble-self-bg":"msg-bubble msg-bubble-bg"),A}));return(A,e)=>{const s=m;return n(),i(s,{class:"msg-item-wrap",style:R({flexDirection:c(Q)?"row-reverse":"row"})},{default:r((()=>[u(s,{class:"avatar-wrap"},{default:r((()=>[u(gA,{size:28,src:C(A.msg.from||"").avatar||c(y).avatarURL||"",placeholder:c(v)},null,8,["src","placeholder"])])),_:1}),u(s,{class:"msg-content",style:R({textAlign:c(Q)?"right":"left"})},{default:r((()=>[u(s,null,{default:r((()=>[c(Q)?E("",!0):(n(),i(s,{key:0,class:"user-nickname"},{default:r((()=>[g(d(C(A.msg.from||"").nickname||c(y).nickname),1)])),_:1})),A.msg.ext.msgQuote&&A.msg.ext.msgQuote.msgID?(n(),i(s,{key:1,class:"msg-quote-container"},{default:r((()=>[u(kA,{msgId:A.msg.ext.msgQuote.msgID,messageQuoteExt:A.msg.ext.msgQuote,titleStyle:{justifyContent:c(Q)?"flex-end":"flex-start"},onJumpToMessage:B},null,8,["msgId","messageQuoteExt","titleStyle"])])),_:1})):E("",!0),u(s,{class:w(k.value),id:"msg-bubble-"+A.msg.id,onLongpress:e[0]||(e[0]=A=>{(A=>{p("onLongPress",o.msg.id),setTimeout((()=>{var e;null==(e=null==I?void 0:I.value)||e.handleLongPress(A,h)}),0)})(A)})},{default:r((()=>[c(U)&&c(Q)&&A.msg.status?(n(),i(SA,{key:0,msg:A.msg},null,8,["msg"])):E("",!0),"txt"===A.msg.type?(n(),i(s,{key:1},{default:r((()=>[u(IA,{msg:A.msg},null,8,["msg"])])),_:1})):"img"===A.msg.type?(n(),i(s,{key:2},{default:r((()=>[u(wA,{msg:A.msg},null,8,["msg"])])),_:1})):"video"===A.msg.type?(n(),i(s,{key:3},{default:r((()=>[u(EA,{msg:A.msg},null,8,["msg"])])),_:1})):"audio"===A.msg.type?(n(),i(s,{key:4},{default:r((()=>[u(QA,{msg:A.msg},null,8,["msg"])])),_:1})):"custom"===A.msg.type?(n(),i(s,{key:5},{default:r((()=>["userCard"===A.msg.customEvent?(n(),i(RA,{key:0,msg:A.msg},null,8,["msg"])):E("",!0)])),_:1})):"file"===A.msg.type?(n(),i(s,{key:6},{default:r((()=>[u(yA,{msg:A.msg},null,8,["msg"])])),_:1})):E("",!0)])),_:1},8,["class","id"])])),_:1}),u(s,{class:"msg-time"},{default:r((()=>[g(d(c(J)(A.msg.time,!0)),1)])),_:1}),o.isSelected?(n(),i(FA,{key:0,ref_key:"actionRef",ref:I,msg:A.msg,isSelected:o.isSelected},null,8,["msg","isSelected"])):E("",!0)])),_:1},8,["style"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-20e461ad"]]),xA=pA(A({__name:"noticeMessageItem",props:{msg:{}},setup(A){var e,s;const t=a.appUserStore,l=A,{msg:o}=l,p=(null==(e=o.noticeInfo)?void 0:e.ext)||{},v=null==(s=o.noticeInfo)?void 0:s.noticeType;return(A,e)=>{const s=m;return n(),i(s,{class:"msg-notice"},{default:r((()=>[u(s,{class:"notice"},{default:r((()=>[u(s,{class:"notice-content"},{default:r((()=>[u(s,{class:"notice-text"},{default:r((()=>["recall"===c(v)?(n(),i(s,{key:0},{default:r((()=>{var A,e,s;return[g(d(`"${c(t).getUserInfoFromStore(null==(s=null==(e=null==(A=c(o))?void 0:A.noticeInfo)?void 0:e.ext)?void 0:s.from).name}" ${c(U)("recallNotice")}`),1)]})),_:1})):"group"===c(v)?(n(),i(s,{key:1},{default:r((()=>{var A,e,s;return[g(d(`"${c(t).getUserInfoFromStore(null==(s=null==(e=null==(A=c(o))?void 0:A.noticeInfo)?void 0:e.ext)?void 0:s.from).name}" ${c(p).operation} ${c(U)("group")}`),1)]})),_:1})):E("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-e480384a"]]),DA=pA(A({__name:"messageList",props:{conversationId:{},conversationType:{}},setup(A,{expose:s}){const p=A,v=e(0),B=e(!1),h=e(""),Q=a.messageStore,y=e(!0),R=e(""),k=e(""),F=e(""),S=e([]),b=e(!0);let x=null;const D=A=>{k.value=A},Y=()=>{k.value=""};l((()=>{var A;x=t((()=>{const A=V(Q.conversationMessagesMap.get(p.conversationId));if(A){if(S.value=A.messageIds.map((A=>V(a.messageStore.messageMap.get(A)))),y.value=A.isLast,R.value=A.cursor,B.value||h.value)return;H((()=>{K(),setTimeout((()=>{b.value=!1}),200)}))}})),Q.conversationMessagesMap.has(p.conversationId)&&!0===(null==(A=Q.conversationMessagesMap.get(p.conversationId))?void 0:A.isGetHistoryMessage)||Q.getHistoryMessages({conversationId:p.conversationId,conversationType:p.conversationType})}));const M=async()=>{if(!y.value&&!0!==B.value){B.value=!0;try{await Q.getHistoryMessages({conversationId:p.conversationId,conversationType:p.conversationType},R.value,(()=>{h.value=S.value[0].id})),H((()=>{const A=setTimeout((()=>{B.value=!1,h.value="",clearTimeout(A)}),300)}))}catch(A){B.value=!1}}},K=()=>{v.value=999*S.value.length,setTimeout((()=>{v.value+=1}),200)},T=A=>{F.value||(h.value=A,F.value=A,setTimeout((()=>{F.value="",h.value=""}),1e3))};return o((()=>{x&&x()})),s({scrollToBottom:K}),(A,e)=>{const s=m,a=O;return n(),i(s,{class:w(["msg-list-wrap",{opacity:b.value}]),onClick:Y},{default:r((()=>[u(a,{"scroll-y":"","scroll-top":v.value,class:"message-scroll-list","scroll-into-view":`msg-${h.value}`,"scroll-anchoring":!0},{default:r((()=>[y.value||B.value?E("",!0):(n(),i(s,{key:0,class:"loadMore",onClick:M},{default:r((()=>[g(d(c(U)("loadMore")),1)])),_:1})),y.value?(n(),i(s,{key:1,class:"isLast"},{default:r((()=>[g(d(c(U)("noMoreMessage")),1)])),_:1})):E("",!0),B.value?(n(),i(s,{key:2,class:"loading"})):E("",!0),(n(!0),I(f,null,C(S.value,((A,e)=>(n(),i(s,{class:w(["scroll-msg-item",{blink:F.value===A.id}]),id:`msg-${A.id}`,key:A.id},{default:r((()=>{var e;return["notice"===(null==(e=null==A?void 0:A.noticeInfo)?void 0:e.type)?(n(),i(xA,{key:0,msg:A},null,8,["msg"])):(n(),i(bA,{key:1,msg:A,onOnLongPress:D,onJumpToMessage:T,isSelected:A.id===k.value},null,8,["msg","isSelected"]))]})),_:2},1032,["class","id"])))),128))])),_:1},8,["scroll-top","scroll-into-view"])])),_:1},8,["class"])}}}),[["__scopeId","data-v-26ca6810"]]),VA=pA(A({__name:"index",props:{preventEvent:{type:Boolean}},emits:["onMessageSend","onShowToolbar","onShowEmojiPicker","onInputTap","onBlur","onFocus","onMention"],setup(A,{expose:s,emit:t}){const l=a.getFeatureConfig(),o=l.inputVideo||l.inputImage,g=A,d=t,p=a.convStore,v=e(!1);e(null);const B=e(""),h=e([]),I=()=>{d("onShowToolbar")},f=()=>{d("onShowEmojiPicker")},C=()=>{d("onInputTap")},Q=A=>{var e,s;const t=null==(e=null==A?void 0:A.detail)?void 0:e.value;a.getFeatureConfig().inputMention&&"groupChat"===(null==(s=a.convStore.currConversation)?void 0:s.conversationType)&&(t.endsWith("@")||t.endsWith("@\n"))&&(v.value=!1,d("onMention",!0))},R=async()=>{let A=P(B.value),e={},s=!1;h.value,h.value.includes(W)&&(s=!0);const t=a.messageStore.quoteMessage;t&&(e={msgID:t.id,msgPreview:Y(t),msgSender:a.appUserStore.getSelfUserInfo().nickname,msgType:t.type},a.messageStore.setQuoteMessage(null));const l=q.message.create({to:p.currConversation.conversationId,chatType:p.currConversation.conversationType,type:"txt",msg:A,ext:{em_at_list:s?W:h.value,ease_chat_uikit_user_info:{avatarURL:a.appUserStore.getSelfUserInfo().avatar,nickname:a.appUserStore.getSelfUserInfo().name},msgQuote:(null==e?void 0:e.msgID)?e:void 0}});B.value="",h.value=[];try{await a.messageStore.sendMessage(l),H((()=>{d("onMessageSend")}))}catch(o){D({title:`send failed: ${o.message}`,icon:"none"})}},k=()=>{v.value=!1,d("onBlur")},F=()=>{v.value=!0,d("onFocus")};return s({insertText(A){B.value+=A},setIsFocus(A){v.value=A},addMentionUserIds(A){h.value=[...new Set([...h.value,...A])]}}),(A,e)=>{const s=N,a=m,t=y;return n(),i(a,{class:"message-input-wrap"},{default:r((()=>[u(a,{class:"send-input",onClick:C},{default:r((()=>[u(s,{class:w([{"prevent-event":g.preventEvent}]),modelValue:B.value,"onUpdate:modelValue":e[0]||(e[0]=A=>B.value=A),"cursor-spacing":"20",type:"text",focus:v.value,"adjust-position":!0,"auto-blur":!0,"confirm-type":"send","confirm-hold":!0,onInput:Q,onConfirm:R,onBlur:k,onFocus:F,placeholder:c(U)("sendMessagePlaceholder")},null,8,["class","modelValue","focus","placeholder"])])),_:1}),c(l).inputEmoji?(n(),i(a,{key:0,class:"icon-wrap"},{default:r((()=>[u(t,{class:"icon",onClick:K(f,["stop"]),src:c("data:image/png;base64,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")},null,8,["src"])])),_:1})):E("",!0),c(o)&&0===B.value.length?(n(),i(a,{key:1,class:"icon-wrap"},{default:r((()=>[u(t,{class:"icon",onClick:K(I,["stop"]),src:c("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAMAAAANIilAAAAAP1BMVEUAAABETlRLUFBETlRGUFlETlVGUFBETlRETlRFT1RGUFVETlNFT1VETlNETlNFT1RFUFVGTVRET1RFTlNETlRLlID0AAAAFHRSTlMA3xDPIIAgkO+/QI+/f2CfcHCvUKu79bEAAAGjSURBVEjH7ZbZkgIhDEVZZcde+P9vnaKnqzKSdMTRR+8j5TELJH3FV5+RqUlL31qTIVXzCqmKbA+SaZaPoRG6z+C3DeLpnLN8AV98O5SXqM4a4pLPP6s8m1qXt2pIx/0mkLhG6REF3B60VjyrzUUzJEsfrBOXsgfN1GsFI3tZdyXYuBP0SpWE2YROXG8obsq9X+RwJvsR7suGAveEzHP41h9RJAJbwcJQdsCBpZmBVQ+tUCOSIGEqtB1/1swcrKCzkHUWLAwKQ6CK7p6Bl9ZaHUqOs3AcJiBABzkYitb8r+aP//SrSNCxe0AJnqgn4b0xilAkCUcO3knYQwvcddpWAPyphulXryq/9Ujef54wGOEfgwEjqRh43BvMhLNw6iWjDno1A9+IvRFmF2DpX2qi/94wMLeixQZTysESAo/bPKFF6XDS0tB338rj2R4x20hz4QiaYB3zcS9PDItmbYW8shV6xpS0QuCq+IHFcuAWEYrqRaqn4wsrmLj19JN+fWof72AfQwga7OMG6fA4Vo4cg90iSCJTyPPVHYbXS+2qEV99RD/k+DCVykkgnQAAAABJRU5ErkJggg==")},null,8,["src"])])),_:1})):(n(),i(a,{key:2,class:"icon-wrap"},{default:r((()=>[u(t,{class:"icon",onClick:K(R,["stop"]),src:c("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKDSURBVHgB7ZpNbhNBEIVfjy3EMkfwDbBwkNhhLgDMCcJN4AaYE4ScYOTA3rBDQohwAnyDRGITJeOpVNtpKUocu6t/Znqk/jZ27N58qXrV3ZMAmUwmk8lkukLZLnxZ0eh6gGMQpvzjkgp8eVLj5GeplugR1sKTU9Ky7+993Dtxe+E50Y6veyMuEf7HL6M9y5IXLwRrf1isGakGH68LLJ5/pQ8690gMa2GlcAZ7khW3bukXFY2bAn/gRjKtbi2s4Ryf88sB3OlcXCZ8SovbfdiXzsQlQ0v/duYIQ2cZF1X4sKIpV2aB8LRWcZHwuKKDQQG9H/vkeBfRxUXCmoA53kU0cVGG1xD+Ij7RMu5S4XcsXaFdglVcLHyb43N0g7e4WFhjeZGIibO4PMMbQu3Hrjhn3EmYGtFFIiZicaeWbmE/dmVvqzsJayYVT+sCn9Btlh9jWTQof5XqQSc6Cxt898gVdwlfO4/57RghUfj++416ff/jITwJcRI6nNOcQgs/chr0Ep5yli+f+uW4rjHiIXiEwHDrbh2szsKTb3T0f4UZrpIbXJplzRne9oVThtcP5TdTOjUueJv6XAOzs1JdbFvgVOEr7mbvaReWvaIGJ2E1wCsQUsBa1OAmTBh37CsWNfTttuQsahBXeDDg/a398nqLGuQtHf/xzl2CiRrkwgrPWqhwcFGDy1PLmPmNJmoQVXg45OncIAbRRQ2ylm6C57c1UYNImFSwA0frogZZhcn7CteZqMFaeP33YfdHOp2LGqyFye3AkYyowV4YnF97khM12GfYLr/JihokQ2tXfpMXNdgL6//ieXiO7o2owVp4tULJx8oZv32LjehJn0QzmUwmk0mQG/bQg18qf9PhAAAAAElFTkSuQmCC")},null,8,["src"])])),_:1}))])),_:1})}}}),[["__scopeId","data-v-dd583c10"]]),YA=pA(A({__name:"itemContainer",props:{title:{},iconUrl:{}},setup(A){const e=A,{title:s,iconUrl:a}=e;return(A,e)=>{const t=y,l=m;return n(),i(l,{class:"tool-item-wrap"},{default:r((()=>[u(l,{class:"icon-wrap"},{default:r((()=>[u(t,{class:"icon",src:c(a)},null,8,["src"])])),_:1}),u(l,null,{default:r((()=>[g(d(c(s)),1)])),_:1})])),_:1})}}}),[["__scopeId","data-v-146dfb83"]]),MA=pA(A({__name:"imageUpload",props:{title:{}},setup(A){const e=U("imageUpload"),s=L("InputToolbarEvent"),t=a.convStore,l=a.getChatConn(),o=()=>{j({count:1,sourceType:["album"],success:function(A){g(A)}})},g=A=>{var e,o;const n=(null==(e=null==A?void 0:A.tempFilePaths)?void 0:e[0])||(null==(o=null==A?void 0:A.tempFiles)?void 0:o[0].tempFilePath),i=`${l.apiUrl}/${l.orgName}/${l.appName}/chatfiles`;if(!n)return;Z();const r=l.token;z({url:i,filePath:n,fileType:"image",name:"file",header:{Authorization:"Bearer "+r},success:async A=>{console.log("图片上传成功",A);const e=JSON.parse(A.data),l=q.message.create({type:"img",to:t.currConversation.conversationId,chatType:t.currConversation.conversationType,url:e.uri+"/"+e.entities[0].uuid,ext:{ease_chat_uikit_user_info:{avatarURL:a.appUserStore.getSelfUserInfo().avatar,nickname:a.appUserStore.getSelfUserInfo().name}}});try{await a.messageStore.sendMessage(l),null==s||s.closeToolbar()}catch(o){D({title:`send failed: ${o.message}`,icon:"none"})}_()},fail:A=>{_(),D({title:U("uploadFailed"),icon:"none"})}})};return(A,s)=>{const a=m;return n(),i(a,{class:"tool-image-wrap tool-item",onClick:o},{default:r((()=>[u(YA,{title:c(e),iconUrl:c("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMpSURBVHgB7ZpBbtpAFIbfGydqlBW9gXMDeoKGDUGVWpzQSt0lOUHbEzQ9QXKDJLtKhWKaDSEL6AnCDeAGZUWjEGb6JsJNiGxs8Bh7yHxSgvE8QP/PeN6bZwAMBoPBYDAYDIZnCYYFlJz324JDGVDkQS8GnIvG1cXPs1lBMw0ovts7ppDPoDddxtZ3m+73vt8gC3oVif+6AuIleSFGp0GDvjOg5Dg251YPVgkBu62Lmvv09Jp/7Joj/3sgQl8gfGGAA9AELsQxSfi/biGjdQwgogEcclPPBZ63GlUXNKL4tvKN5nf94QzafnGBa4DuMCvabF1ZA6JiDIBnzhooxHGc3A1s5DbgZuC6rhYZQ4kBUvhfYR0POVD6HOWGYFEhVZlZgWWF2JeAFD/k1rUQcEBPH6fPPOejntxLQIaJbcCQMyqZwQ4apw3JKWQYBYsgOiEB9hvnQ2Z3kiqygB0WMBrDShvQDwuwLBEakxYqLoHzmaO0kWq61Q5klNhp8JbdnbwQ1j5lAdtvHBEPYQG8mkIeJ5lKY8+ADhU8iOMCHU7NBBLeEYy9mvfbl2lzp1xpU2r9I9Oo/KOaoicbNNIUUIySUrjpuv3Wr9rBJhu/pOJnSz5eNqqFK/dHd573kSIpbbZpNm0/GbLJ0iNZb5ScjzYoRGkpPCl/FyqBJy24o5Aw6lSN2mRCQdVlkYnNUETxHp4JNiggdQPmFO+hzIRUDVhQvIc0oR53YUzNgJjiPfK0MLbjmJCKAYrEe8QyYekGKBbvkZf9CFiApRqQkPh7ZD+CCqi5t95LMyBJ8R6LmKC0EApiGeI9pAn0eX06/B0lPnEDlin+ATyiW2OR7mQlegmkI36CgLBO1T2JGZCq+DlIxABdxEuUG7DjVD7pIl6i1IDibmWfbq2fgEYoM0CKhzGcgWb4pkFkMKBv8hGiTL19l4Pl2+zgOHqto3iJvwEAXTF9Kn/H+TVJBV1B5L7d68CfyRXLlXrUXJp1ZGv+slHb8hsLXANucXxI9szV1MwiUjzieiFwHEIoOXsHQrB9KrJt0AiBOKAZ3Nik+xa6/FbBYDAYDAaDwbBM/gEtPSy1+Txy4wAAAABJRU5ErkJggg==")},null,8,["title","iconUrl"])])),_:1})}}}),[["__scopeId","data-v-5f09b6e0"]]),KA=pA(A({__name:"videoUpload",props:{title:{}},setup(A){const e=U("videoUpload"),s=L("InputToolbarEvent"),t=a.getChatConn(),l=a.convStore,o=()=>{$({sourceType:["camera","album"],success:function(A){g(A)}})},g=A=>{const e=null==A?void 0:A.tempFilePath,o=`${t.apiUrl}/${t.orgName}/${t.appName}/chatfiles`;if(!e)return;Z();const n=t.token;z({url:o,filePath:e,fileType:"video",name:"file",header:{Authorization:"Bearer "+n},success:async A=>{const e=JSON.parse(A.data),t=q.message.create({type:"video",to:l.currConversation.conversationId,chatType:l.currConversation.conversationType,file_length:A.duration,body:{url:e.uri+"/"+e.entities[0].uuid},ext:{ease_chat_uikit_user_info:{avatarURL:a.appUserStore.getSelfUserInfo().avatar,nickname:a.appUserStore.getSelfUserInfo().name}}});try{await a.messageStore.sendMessage(t),null==s||s.closeToolbar()}catch(o){D({title:`send failed: ${o.message}`,icon:"none"})}_()},fail:A=>{_(),D({title:U("uploadFailed"),icon:"none"})}})};return(A,s)=>{const a=m;return n(),i(a,{class:"tool-video-wrap tool-item",onClick:o},{default:r((()=>[u(YA,{title:c(e),iconUrl:c("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKXSURBVHgB7ZpBctowFIb/Z8hMmxVHcE5QjtAuSpjOEBxoZ7oL3KCcoOEEJCeA7LqARC4bSBdNTxBuQI7gVadTgl7lQNIktRMWtS2BvgUzPMkL/X7v6enJgMVisVgsFovFspHQcxPK3vvXLFEFcRFmEUjJ/rfhae+pSU8KUNqrddSUTzCbieNs7Y/El6uoQSfuKbX4z2uw+JAi86wbNxjpAWXPc6XMTbFOMPbPhwPx2JyPnpv3wt9biHDFhJYDCmAIkrmjlnCXt8hReQxYUQCJwoP/TCfnfl/AIEqVelv599lfC7lR82JzgOk4udW8dW0FWBUrADacVATwPK9Q9j660JDEBVDZ2PupagopZ9PSXv1SNyGS9wCCKqfvttViKMRutd7VRYg0QsB9bGBGQwnx/W2l1kDGZJkEXSLqqrCYZukNOuwCbpZhoc02eBsWu5VaqidQ3eoAl4k6YViEuwdSQNdCyA0PMmmEhdaV4DIspovmTDIYUgrTYVK5wZyzgEOvkADGCEDEP5AAeegOIQDT8UgMekgArQVQleIFUb458qNb2v8DLQUIm7Bq8c2R6F8gYfQSYOnuY79/iJTQRgD11nsvad4Svki19Z65AIs4RzsNd48iOwGUu5Ok9vhr/wgZkkZHKPjXhONtmu+Mh9kuPiRxD3CIW5Lp5nIya3ePInEBRuK0p7rC4hdeFOKuqLMklRwgxE1m1/Ji1V6MYMOxAmDDiUyC5CBged/C1XfeByGRM+YLEebZwSrzogUAJvzQVLyW8hKQMBUieRJpj3ugVK2fgZFKazppwuP12B/sRI3F5oDfNG8qeSYwnEVvYetN7DieoezVGszOgQoqFwahLlhUbwH+tnN9tCzELBaLxWKxWCyWe/wBb2fc7jtZNEgAAAAASUVORK5CYII=")},null,8,["title","iconUrl"])])),_:1})}}}),[["__scopeId","data-v-ada16353"]]),TA=pA(A({__name:"fileUpload",props:{title:{}},setup(A){const e=U("file"),s=L("InputToolbarEvent"),t=a.getChatConn(),l=a.convStore,o=()=>{AA({count:1,success(A){g({tempFile:A.tempFiles[0]})}})},g=A=>{const e=null==A?void 0:A.tempFile,o=`${t.apiUrl}/${t.orgName}/${t.appName}/chatfiles`;if(!e)return;Z();const n=t.token,i={url:o,filePath:e.path,fileType:e.type,name:"file",header:{Authorization:"Bearer "+n},success:async A=>{const t=JSON.parse(A.data),o=q.message.create({type:"file",to:l.currConversation.conversationId,chatType:l.currConversation.conversationType,body:{url:t.uri+"/"+t.entities[0].uuid,filename:e.name,file_length:e.size},ext:{ease_chat_uikit_user_info:{avatarURL:a.appUserStore.getSelfUserInfo().avatar,nickname:a.appUserStore.getSelfUserInfo().name}}});try{await a.messageStore.sendMessage(o),null==s||s.closeToolbar()}catch(n){D({title:`send failed: ${n.message}`,icon:"none"})}_()},fail:A=>{_(),D({title:U("uploadFailed"),icon:"none"})}};z(i)};return(A,s)=>{const a=m;return n(),i(a,{class:"tool-video-wrap tool-item",onClick:o},{default:r((()=>[u(YA,{title:c(e),iconUrl:c("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAF6SURBVHgB7dqxUQJBFMbx750EjhElUAJ2QCJDIu4ggZlSgdqBHThWoA2gKyZKRAmUQAcSGcmue2jozB7rIAvv+8Vv5u7+c+wuAwARERER6SRVhjqm38LCNbACB5mPX4YWmYsGaHd7t2HsCmmm49HwEBkr4iPJD19qHh33LpCxCgH+eIFCzpGxtQfwHq3lGpKptQcoOefvO+asgQxVWARPPbbPXOAf3kaP17HBf3kDNqDuw+Ld7vZvYoO7GuCHv4xN7HgA1GMDux4gigGgnPoANaQQ2ANZDKy1c2SgY0zD+b0neDSxoqQ3wLviOZeHL71aO/PO3yFBUoCicCfIiDGmLoUk3VPSRyB8wTHhiPweztFZvAUfbrnfR/f836StAd/CcTPtojnhNgjlGADKMQCUYwAoxwBQjgGgHANAOQaAcgwA5RgAyjEAlIsGEMEEW0pEJrGZCgEWgxBhhi1T3rNIbRCdQ0Upf5fdmL1ito/PaU6/XxIRERFRbr4AIkJSTyy6V70AAAAASUVORK5CYII=")},null,8,["title","iconUrl"])])),_:1})}}}),[["__scopeId","data-v-c06ff4fe"]]),XA=pA(A({__name:"userCard",emits:["onUserCardButtonTap"],setup(A,{emit:e}){const s=L("InputToolbarEvent"),a=e,t=()=>{null==s||s.closeToolbar(),a("onUserCardButtonTap")};return(A,e)=>{const s=m;return n(),i(s,{class:"tool-item",onClick:t},{default:r((()=>[u(YA,{title:c(U)("userCard"),iconUrl:c("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAM8SURBVHgB7dq9TxRBGAbwZ2YhMVRnZ+eaQ8lBIXZ2ngXmGnUlmtiJnSV0dnidpf4FQEci6AINXOPZ0Xk2fJicWTpLaPzIsfM6cwQlxuDs3rybI8wvuYQje3c7z87NzbyzgOd5nud555VAgWpRFColn+iPjfTTUD9K+rEvBFpQYkUEA/F6vJigQIUEEEVR6ZuSs/rjpv9/NL1orL6toyDsARxd9eA9jq64rUTKwdtF9AbWAHI2/lgyJNMbcRzvg5EEox4ab4Tfu18bXmwBTNydnEL+xneRHjNq0cMqGLEFIIRwcvWIiLUXsIwBE9GjcaHURziix4KLXGMBSw+QoCoc+omgCiYsAShFIRxSqQjBhCUAcTTDc4aE2/c7ifVn8CzwAeCc8wHgnPMBgAHpIgccEgS2FSFPDyBqwSERwOn7ncQSQCdQMRzR5bJkPV5qgglLAE29cNEn3oQDRGIBjNgGQSXkDHpkrr6UA/NgFIDJl52tr8OVsQM9ItaQk5Q0sx6/aYIRWwBGe2drszwyekX/OY7MRH1jZfkVmLEGYLR3t+PyyJgpvFRtXyNIzDTWll6iAOwBGO3drWa5MvpJp3ATpyyVdRmtKaV4urG6tIiCFLozZJhyWbdiRHT99z+F0OEUvyvkeUXuDaZBVXf9kp4fhELQ5X8dpyc9e5JUgkAmF3DY4t4VMlgCMA3+kcqIpLil5wFVyr9BkpgZJSmsDAVpkyMQpwGYXRx9svcJNAW4L2TqMOaFGKy7HCydBGA2QYmCOSL73/peuAyi53nAnXuTs0TSrP5CFGecSE2XRypmovUBPcjdA4q+6qdoSTn4IG9vyBVAj/v+HHLfUJE5gD5s/LFcIWSuB+jGv0P/Nd7QX8nOHDLKNAiamx70guUZ+lc4fK1y0P68vWn7gkw9wNVND5wo4zlaB2BWcejPrv+3Ui16HNoebB1AoOfxOCMEOtYVKOsA0lSFOCMOU2l9sezHgCBg25xwLQgosT3WOoAOOonuW+zL015l3UixDsBsdugh9jX6XNaNlEzzgG5xM3eZuxALjdVlixuy/8i8GjRl7quVyh5BhvrpJfQBYQonJOqNteXn8DzP8zzPs/QLWdgdSnEUuqIAAAAASUVORK5CYII=")},null,8,["title","iconUrl"])])),_:1})}}}),[["__scopeId","data-v-83fec84a"]]),JA=pA(A({__name:"index",emits:["onUserCardButtonTap"],setup(A,{emit:e}){const s=a.getFeatureConfig(),t=e,l=()=>{t("onUserCardButtonTap")};return(A,e)=>{const a=m,t=eA,o=sA;return n(),i(a,{class:"message-input-toolbar"},{default:r((()=>[u(o,{class:"swiper"},{default:r((()=>[u(t,{class:"swiper-item"},{default:r((()=>[u(a,{class:"item-wrap"},{default:r((()=>[c(s).inputImage?(n(),i(a,{key:0,class:"item"},{default:r((()=>[u(MA)])),_:1})):E("",!0),c(s).inputVideo?(n(),i(a,{key:1,class:"item",style:{width:"25%"}},{default:r((()=>[u(KA)])),_:1})):E("",!0),c(s).inputFile?(n(),i(a,{key:2,class:"item",style:{width:"25%"}},{default:r((()=>[u(TA)])),_:1})):E("",!0),c(s).userCard?(n(),i(a,{key:3,class:"item",style:{width:"25%"}},{default:r((()=>[u(XA,{onOnUserCardButtonTap:l})])),_:1})):E("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-3aeb9834"]]),GA=pA(A({__name:"emojiPicker",emits:["onEmojiPick"],setup(A,{emit:s}){const a=e(aA(tA,7));tA.forEach((A=>{}));const t=s;return(A,e)=>{const s=y,l=m;return n(),i(l,{class:"emoji-picker-wrap"},{default:r((()=>[u(l,{class:"emojis-wrap"},{default:r((()=>[(n(!0),I(f,null,C(a.value,((A,e)=>(n(),i(l,{class:"emojis-row",key:e},{default:r((()=>[(n(!0),I(f,null,C(A,(A=>(n(),i(l,{key:A.alt,class:"emoji-item-wrap"},{default:r((()=>[u(s,{class:"emoji",src:A.url,onClick:e=>{return s=A.alt,void t("onEmojiPick",s);var s}},null,8,["src","onClick"])])),_:2},1024)))),128)),e===a.value.length-1?(n(),I(f,{key:0},[u(l,{class:"emoji-empty"}),u(l,{class:"emoji-empty"}),u(l,{class:"emoji-empty"}),u(l,{class:"emoji-empty"})],64)):E("",!0)])),_:2},1024)))),128))])),_:1})])),_:1})}}}),[["__scopeId","data-v-cd394043"]]),HA=pA(A({__name:"messageQuotePanel",setup(A){const s=e(null);t((()=>{s.value=a.messageStore.quoteMessage}));const l=()=>{a.messageStore.setQuoteMessage(null)};return o((()=>{l()})),(A,e)=>{const a=m;return s.value?(n(),i(a,{key:0,class:"msg-quote-panel-wrap"},{default:r((()=>[u(a,{class:"left-wrap"},{default:r((()=>[u(kA,{isReplying:!0})])),_:1}),u(a,{class:"cancel",onClick:l})])),_:1})):E("",!0)}}}),[["__scopeId","data-v-51b01c64"]]),OA=pA(A({__name:"messageEdit",setup(A){const l=e(null),p=e(""),v=e(!0),B=t((()=>{var A;l.value=a.messageStore.editingMessage,p.value=null==(A=l.value)?void 0:A.msg})),h=s((()=>{var A;return p.value!==(null==(A=l.value)?void 0:A.msg)})),I=()=>{a.messageStore.setEditingMessage(null)},f=()=>{if(h.value){const A=q.message.create({to:l.value.to,type:l.value.type,chatType:l.value.chatType,msg:p.value});a.messageStore.modifyServerMessage(l.value.id,A),a.messageStore.setEditingMessage(null)}};return o((()=>{B()})),(A,e)=>{const s=m,a=lA;return l.value?(n(),i(s,{key:0,style:{width:"100%"}},{default:r((()=>[u(s,{class:"mask",onClick:I}),u(s,{class:"msg-edit-wrap"},{default:r((()=>[u(s,{class:"title"},{default:r((()=>[g(d(c(U)("messageEditing")),1)])),_:1}),u(s,{class:"content"},{default:r((()=>[u(a,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=A=>p.value=A),class:"edit-input","cursor-spacing":"20","auto-height":!0,focus:v.value,"confirm-type":"send"},null,8,["modelValue","focus"]),u(s,{onClick:f,class:w(h.value?"edit":"edit-disabled")},null,8,["class"])])),_:1})])),_:1})])),_:1})):E("",!0)}}}),[["__scopeId","data-v-ed3b740c"]]),PA=pA(A({__name:"index",props:{height:{},maskClosable:{type:Boolean},borderRadius:{}},setup(A,{expose:s}){const a=A,t=e(!1),l=e(a.height||300),o=e(null),g=()=>{p(!1,(()=>{t.value=!1}))},d=()=>{a.maskClosable&&g()},p=(A,e)=>{const s=rA({duration:300,timingFunction:"ease-in-out"});A?s.translateY(0).step():s.translateY(l.value).step(),o.value=s.export(),e&&setTimeout(e,300)},v=(A,e)=>{const s=rA({duration:300,timingFunction:"ease"});A?s.opacity(0).step():s.opacity(1).step(),o.value=s.export()},B=o;return s({openPopup:()=>{t.value=!0,p(!0)},closePopup:g}),(A,e)=>{const s=m;return n(),i(s,{class:w(["popup-container",{"popup-container-hide ":!t.value}])},{default:r((()=>[oA(u(s,{class:"mask",onClick:d,animation:v},null,512),[[nA,t.value]]),u(s,{class:w(["popup",{"popup-show":t.value}]),animation:c(B),style:R({borderTopLeftRadius:a.borderRadius,borderTopRightRadius:a.borderRadius,height:`${l.value}px`})},{default:r((()=>[u(s,{class:"popup-content"},{default:r((()=>[iA(A.$slots,"default",{},void 0,!0)])),_:3})])),_:3},8,["class","animation","style"])])),_:3},8,["class"])}}}),[["__scopeId","data-v-4ba8cb03"]]),WA=pA(A({__name:"index",emits:["onSelect"],setup(A,{expose:s,emit:t}){const l=t,o=e([]),p=e(!0),v=e(null);let B=!1,h=1;const w=async()=>{var A;B=!0;const e=(null==(A=a.convStore.currConversation)?void 0:A.conversationId)||"";try{const A=(await a.groupStore.getGroupMembers(e,h)).data||[];o.value.push(...A),A.length<uA&&(p.value=!1),B=!1}catch(s){B=!1}},E=()=>{B||!1===p.value||(h++,w())},Q=A=>{l("onSelect",[A]),y()},y=()=>v.value.closePopup();return s({showPopup:()=>{v.value.openPopup(),0===o.value.length&&w()},hidePopup:y}),(A,e)=>{const s=m,t=O;return n(),i(s,null,{default:r((()=>[u(PA,{height:500,borderRadius:"10px",maskClosable:!0,ref_key:"popupRef",ref:v},{default:r((()=>[u(s,{class:"content-wrap"},{default:r((()=>[u(s,{class:"header"},{default:r((()=>[u(s,{class:"left",onClick:y},{default:r((()=>[u(s,{class:"arrow-left"}),u(s,{class:"mention"},{default:r((()=>[g(d(c(U)("mention")),1)])),_:1})])),_:1})])),_:1}),u(s,{class:"content"},{default:r((()=>[u(t,{"scroll-y":"",style:{height:"100%"},onScrolltolower:E},{default:r((()=>[(n(),i(mA,{class:"member-item",key:c(U)("mentionAll"),avatar:c("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAV8SURBVHgB7Zw/bBNXHMd/dw5dWikJSxhaEbULWewOLUOqhjCEpWoAqSuVkJqtkSqVMShFycjQKt1IhZRMFR3Kv4UMQJAYgAF7AIRkcMgUBhIkswT7jve989mXy7+7+71777DeR4odx3Hi+9zv/fv9ns+iKJfdUXF7khw6Je4HyUBk0WNyxZdNF+isVdv6VMBlt0/cTgtxv5Fhd2z6U9xC5AYe+gIhz6Xb4utrMuwPItKi45Bot340beQlwHc1jW8tEX2Dotm+JENyHDpui5tpMqSjQKdsEYOm6abFpZO26ftYDNpkYGEEMjECmRiBTIxAJkYgEyOQiRHIpIc+Ivo+ITo24FCvuF+pE5XXbdrYJK18FAIhbark0MiAG3mmSYtVm2YqBU+oDiz6x3Upx1z8tkmTR5x9f2+2IkSWC6SaXPeB89/Fkwemig5NDjVJNbkVeF402TNfxpMXcPEbh0r9ahtULgVisBj/Ipm8ADR5leRSIEbWn+4UaKGa/O1hoBn8VF0UahWISCv1O/TzV4430h7+rPPcSt2iifsFOvco+cDwY8roTYOWaQxETRWbopm6QmI4WppUWbdo7qndjj58j4icH47fNEsHuzgCEW0Pfmh491vl+RTFIHBJyIIwRCjAXC9NJKpAqcDJIceTs5O4KGeE4CujjfZjRCKiM28oE+g322R9EwaE88VO0/39Yf6iUJlA9HlxIi/Kr0NOuykvr1na175RlAhE9KHPSwPkTR7pROFiNV8zLyXvhrs6GDnUeX05Z/2gIoG8eVkxdAJe1fcXuFJXJ1lRE+ZFYNAHxuXuWpcJVMnKO0sMNuoOq+sEzpbVHlJXCcQIvVA1AlOBOeK5R+oPR0kyYWMTnXo2C/yN9yL58MT2Uvo6UCKQO60Iz/1wGq6tWvR206/KLVat1gnSgxKBy695B1h503k9muryWn6KiUrivvzG8g48LTOh5ok5ITLOKrPOe6HsVKLkuHSikfh1GFmDLgBr6uen32/7Hcz9vEK7OFH3xIm6u6au4K60LoyqWZLSI8SM3Sq0BSKXGDcpgX7y+mr20xrlhfW4EqLyUDO5dSJ5xQ2vxwidlUjlYz8KRWjOELQb6C/D8tB0Lw2nS0hgHR6UCMJFK1lo29qBA0PGGakuFIHQh9XqdmuU7cjFoIG+syihYI4TMrbUI3UfTe73xgRANuokx0Ru8DBjBJYtUbtARFjfAf8tYFURZ/SESGz9SCsSEo/e7JEyUisTGOzt+15EEppv6SDtKgAri8q6f6DLrWnJThHDEYkqn4xSaeYCd9/bl4yg4B6ViZPx32gzVR858O8BdhRmJhDiMHJys9FREJWLL6xtewGTzBEDjt4oeOtpDtKnMWiqV0REYM4mWx7A30R9+fnpxpZpCaZHc0+TNclSP7GRKhAHhG0b4wo290AklnXhlQ3ygUnW3LV3xEaaQMhbGmtkEnV7EV0e/iIiMW6/VlnnH74UgbrkBUDiyIAf9egj/47RlGfKchIOUgRi24YueQHzw50tIHPP9pYDebMVOfts2OksvOm02zZkghM4/rlDCy98eRP3e6h3h70411flZrDZAlVv6t6LkUO+QIB0VviyOFnBbsK9CXcNdBtdVRd+q6G4xBaYpz17OnZusQVCnqwRjQMStAsa9g5K+Y9Y5Ov4nFpAkMHWgdRkgpem6qcdpw9ZgUqczs3nUsuaWAX4qab87abPCvOJdSZGIBMjkIkRyMQIZGIEMjECmRiBTCCwRoZ0WPQY11C9SoZ0uBDYpP/JkA6bLtg0Yd0RJv8iQzLg7KxV8weRAv3hXd7cEA+4gjMKRmFcWB/XhjeRuD9w1LqOPh5uzzvh0vBNYdemkrnGdJuaN9hivECXF+IDB84e6ebKmewAAAAASUVORK5CYII="),user:{userId:c(U)("mentionAll")},onClick:e[0]||(e[0]=A=>Q(c(W)))},null,8,["avatar","user"])),(n(!0),I(f,null,C(o.value,(A=>oA((n(),i(mA,{class:"member-item",key:A.member||A.owner,user:{userId:A.member||A.owner},onClick:e=>Q(A.member||A.owner)},null,8,["user","onClick"])),[[nA,(A.member||A.owner)!==c(a).getChatConn().user]]))),128))])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})}}}),[["__scopeId","data-v-5a919428"]]),qA=pA(A({__name:"index",emits:["onSelect"],setup(A,{expose:s,emit:l}){const p=l,v=e(null),B=e([]),h=t((()=>{B.value=a.contactStore.contacts.map((A=>({...A,...a.appUserStore.getUserInfoFromStore(A.userId),id:A.userId})))})),I=()=>v.value.closePopup();return s({showPopup:()=>v.value.openPopup(),hidePopup:I}),o((()=>{h()})),(A,e)=>{const s=m;return n(),i(s,null,{default:r((()=>[u(PA,{height:500,borderRadius:"10px",maskClosable:!0,ref_key:"popupRef",ref:v},{default:r((()=>[u(s,{class:"content-wrap"},{default:r((()=>[u(s,{class:"header"},{default:r((()=>[u(s,{class:"left",onClick:I},{default:r((()=>[u(s,{class:"arrow-left"}),u(s,{class:"share"},{default:r((()=>[g(d(c(U)("shareContact")),1)])),_:1})])),_:1})])),_:1}),u(s,{class:"content"},{default:r((()=>[u(vA,{class:"contact-indexed-list",options:B.value},{indexedItem:r((A=>[u(mA,{class:"contact-item",user:A.item,onClick:e=>{return s=A.item.userId,p("onSelect",[s]),void I();var s}},null,8,["user","onClick"])])),_:1},8,["options"])])),_:1})])),_:1})])),_:1},512)])),_:1})}}}),[["__scopeId","data-v-85dbadc8"]]),NA=pA(A({__name:"index",setup(A){const g=e(null),d=e(null),p=e(null),v=e(null),B=e(""),h=e(!1),I=e(!1),f=e(""),C=a.getFeatureConfig(),w=s((()=>h.value||I.value)),Q=t((()=>{var A,e;a.messageStore.quoteMessage?null==(A=null==d?void 0:d.value)||A.setIsFocus(!0):null==(e=null==d?void 0:d.value)||e.setIsFocus(!1)})),y=()=>{var A;R(),null==(A=null==d?void 0:d.value)||A.setIsFocus(!0)},R=()=>{!0===h.value&&(h.value=!1),!0===I.value&&(I.value=!1)},k=A=>{null==d||d.value.insertText(A)},F=()=>{var A;null==(A=null==p?void 0:p.value)||A.showPopup()},S=()=>{var A;null==(A=null==v?void 0:v.value)||A.showPopup()},b=A=>{const e=A.map((A=>A===W?U("mentionAll"):a.appUserStore.getUserInfoFromStore(A).name));let s=e.join("");0!==e.length?(null==d||d.value.addMentionUserIds(A),null==d||d.value.insertText(s)):s=e.join("@")},x=A=>{const e=A[0],s=a.appUserStore.getUserInfoFromStore(e),t=q.message.create({type:"custom",to:a.convStore.currConversation.conversationId,chatType:a.convStore.currConversation.conversationType,ext:{ease_chat_uikit_user_info:{avatarURL:a.appUserStore.getSelfUserInfo().avatar,nickname:a.appUserStore.getSelfUserInfo().name}},customEvent:"userCard",customExts:{avatar:s.avatar,nickname:s.name,uid:e}});a.messageStore.sendMessage(t)};return l((()=>{(B.value||f.value)&&a.convStore.markConversationRead({conversationId:B.value,conversationType:f.value})})),o((()=>{a.convStore.setCurrentConversation(null),Q()})),BA((A=>{f.value=null==A?void 0:A.type,B.value=null==A?void 0:A.id,(null==A?void 0:A.id)&&a.convStore.setCurrentConversation({conversationId:B.value,conversationType:f.value})})),cA("InputToolbarEvent",{closeToolbar:R}),(A,e)=>{const s=m;return n(),i(s,{class:"chat-wrap"},{default:r((()=>[u(hA),u(s,{class:"msgs-wrap"},{default:r((()=>[w.value?(n(),i(s,{key:0,class:"mask",onClick:R})):E("",!0),u(DA,{ref_key:"msgListRef",ref:g,conversationId:B.value,conversationType:f.value},null,8,["conversationId","conversationType"])])),_:1}),u(HA),u(OA),u(s,{class:"chat-input-wrap"},{default:r((()=>[u(VA,{ref_key:"msgInputRef",ref:d,preventEvent:h.value||I.value,onOnInputTap:y,onOnMention:F,onOnShowToolbar:e[0]||(e[0]=A=>{h.value=!0,I.value=!1}),onOnShowEmojiPicker:e[1]||(e[1]=A=>{I.value=!0,h.value=!1})},null,8,["preventEvent"])])),_:1}),h.value?(n(),i(s,{key:0,class:"chat-input-toolbar-wrap"},{default:r((()=>[u(JA,{onOnUserCardButtonTap:S})])),_:1})):E("",!0),I.value?(n(),i(GA,{key:1,onOnEmojiPick:k})):E("",!0),c(C).inputMention?(n(),i(WA,{key:2,ref_key:"mentionListRef",ref:p,onOnSelect:b},null,512)):E("",!0),c(C).userCard?(n(),i(qA,{key:3,ref_key:"contactListRef",ref:v,onOnSelect:x},null,512)):E("",!0)])),_:1})}}}),[["__scopeId","data-v-22ed1938"]]);export{NA as default};
