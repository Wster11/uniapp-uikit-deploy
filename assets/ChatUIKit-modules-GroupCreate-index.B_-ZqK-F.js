import{d as e,r as a,z as t,a as s,c as r,w as l,b as o,u as n,J as c,K as u,L as i,h as d,m as p,H as h,s as m,k as f,l as v,v as k,o as C,t as g,e as _}from"./index-MPuTzaoH.js";import{S as x}from"./index.D0WZ22Cl.js";import{N as I}from"./index.CpeIJ2eb.js";import{U as b}from"./index.CvQ9w7D0.js";import{E as S}from"./index.DngBWMxM.js";import{I as w}from"./index.V7mOTGWq.js";import{U as y}from"./index.DYbwXQgf.js";import{S as L}from"./index.CTrzd9cy.js";import{_ as U}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./index.CCg7-MOq.js";const j=U(e({__name:"searchList",props:{checkedList:{}},emits:["checkboxChange","cancel"],setup(e,{emit:k}){const C=e,g=k,_=a(null),x=a(""),w=e=>{x.value=e},y=e=>{const a=e.detail.value;g("checkboxChange",a)},U=t((()=>x.value?m.contactStore.contacts.filter((e=>m.appUserStore.getUserInfoFromStore(e.userId).name.includes(x.value))):[])),j=()=>{g("cancel")};return(e,a)=>{const t=d,m=f,k=v,g=p;return s(),r(t,{class:"search-list-wrap"},{default:l((()=>[o(I,{onOnLeftTap:j},{left:l((()=>[o(t,{class:"input-wrap"},{default:l((()=>[o(L,{ref_key:"searchRef",ref:_,placeholder:n(h)("searchContact"),onInput:w,onCancel:j},null,8,["placeholder"])])),_:1})])),_:1}),U.value.length?(s(),r(t,{key:0,class:"search-content"},{default:l((()=>[o(g,{onChange:y},{default:l((()=>[(s(!0),c(i,null,u(U.value,(e=>(s(),r(k,{class:"label"},{default:l((()=>[o(m,{class:"checkbox",backgroundColor:"#f9fafa",borderColor:"#ACB4B9",activeBackgroundColor:"#009DFF",activeBorderColor:"#009DFF",style:{transform:"scale(0.8)"},iconColor:"#fff",value:e.userId,checked:C.checkedList.includes(e.userId)},null,8,["value","checked"]),(s(),r(b,{key:e.conversationId,class:"search-item",user:{userId:e.userId}},null,8,["user"]))])),_:2},1024)))),256))])),_:1})])),_:1})):(s(),r(S,{key:1}))])),_:1})}}}),[["__scopeId","data-v-6e55973e"]]),F=U(e({__name:"index",setup(e){const t=a([]),c=a(!1),u=a([]);k((()=>{t.value=m.contactStore.contacts.map((e=>({...e,...m.appUserStore.getUserInfoFromStore(e.userId),id:e.userId})))}));const i=e=>{u.value=e},p=()=>{if(!u.value.length)return;let e=u.value.map((e=>m.appUserStore.getUserInfoFromStore(e).name)).join("、");e=m.appUserStore.getSelfUserInfo().name+"、"+e;const a={groupname:e,members:u.value,desc:e,public:!0,allowinvites:!0,inviteNeedConfirm:!1,approval:!1,maxusers:1e3};uni.showLoading({title:"loading",mask:!0}),m.groupStore.createGroup({data:a}).then((e=>{var a;uni.redirectTo({url:`/ChatUIKit/modules/Chat/index?type=groupChat&id=${null==(a=e.data)?void 0:a.groupid}`})})).finally((()=>{uni.hideLoading()}))},f=()=>{uni.switchTab({url:"/ChatUIKit/modules/Conversation/index"})};return C((()=>{})),(e,a)=>{const m=d;return s(),r(m,{class:"group-create-wrap"},{default:l((()=>[c.value?(s(),r(j,{key:1,class:"search-list-comp",checkedList:u.value,onCheckboxChange:i,onCancel:a[1]||(a[1]=e=>c.value=!1)},null,8,["checkedList"])):(s(),r(m,{key:0,class:"group-create-content"},{default:l((()=>[o(I,{class:"nav-bar",onOnLeftTap:f},{left:l((()=>[o(m,{class:"title",textContent:g(n(h)("createGroup"))},null,8,["textContent"])])),_:1}),o(m,{class:"search-wrap",onClick:a[0]||(a[0]=e=>c.value=!0)},{default:l((()=>[o(x,{placeholder:n(h)("searchContact")},null,8,["placeholder"])])),_:1}),t.value.length?(s(),r(w,{key:0,class:"contact-indexed-list",checkedList:u.value,options:t.value,withCheckbox:!0,onCheckboxChange:i},{indexedItem:l((e=>[o(b,{class:"contact-item",user:e.item},null,8,["user"])])),_:1},8,["checkedList","options"])):(s(),r(m,{key:1,class:"empty-wrap"},{default:l((()=>[o(S)])),_:1})),o(m,{class:"create-btn-wrap"},{default:l((()=>[o(y,{class:"crate-btn",disabled:!u.value.length,onClick:p},{default:l((()=>[_(g(n(h)("createGroupBtn")+"("+u.value.length+")"),1)])),_:1},8,["disabled"])])),_:1})])),_:1}))])),_:1})}}}),[["__scopeId","data-v-1d57af22"]]);export{F as default};
