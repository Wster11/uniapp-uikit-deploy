import{d as e,a,c as n,w as t,b as s,Q as o,J as l,L as r,K as i,u as A,e as c,t as u,R as v,h as p,r as d,H as m,v as g,s as f,o as C,x as w,g as h,T as I,z as S,G as x,V as y,W as B,X as T,Y as N}from"./index-CdYspkyg.js";import{A as k}from"./index.DWAM1j9T.js";import{N as K}from"./index.DHzVnxI0.js";import{_ as E}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{S as Y}from"./index.D92CTNTu.js";import{E as X}from"./index.D1L-DgDv.js";const U=E(e({__name:"index",props:{popStyle:{},options:{}},emits:["onMenuTap","onMenuClose"],setup(e,{emit:d}){const m=d,g=e.options;return(e,d)=>{const f=v,C=p;return a(),n(C,{class:"mask",onClick:d[0]||(d[0]=e=>m("onMenuClose"))},{default:t((()=>[s(C,{class:"pop show",style:o(e.popStyle)},{default:t((()=>[(a(!0),l(r,null,i(A(g),((e,o)=>(a(),n(C,{class:"pop-menu-item",key:e.type,title:e.name,onClick:a=>{return n={type:e.type},m("onMenuTap",n),void m("onMenuClose");var n}},{default:t((()=>[s(C,{class:"icon"},{default:t((()=>[s(f,{class:"icon-img",src:e.icon},null,8,["src"])])),_:2},1024),s(C,null,{default:t((()=>[c(u(e.name),1)])),_:2},1024)])),_:2},1032,["title","onClick"])))),128))])),_:1},8,["style"])])),_:1})}}}),[["__scopeId","data-v-ccd6f783"]]),M=E(e({__name:"index",setup(e){const o=d(!1),l=I?{right:"40px",bottom:"calc(120px - var(--safe-area-inset-bottom))"}:{right:"25px",top:"calc(var(--status-bar-height) + 50px"},r=d({}),i=[{name:m("newChatButton"),type:"newConversation",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALxSURBVHgB7Zg/ThtBFMa/NyMXSUVusChRIjrfINAYGvCCKdLSpQs5gc0JEk5A0qXAykITQ4PTpXSHEgnFRyANKLF2JvNAixJ7ZnZs79qNf9Vq3vPsp7fj92eABQsWzBRCQWzEryKVDqoEijRh6W5zjWsN3Rey0uskn/oogKkEb8S7q1qhDuhYA1GOe58IXaLKwTTiJxK8EceR1vJIa6xiAozwD5MKlxiT9bjxRivRQX5EfVS1VvtPX6zg6vvl13F+GBzhOI6XbrX8PGlUnQIIySNK95IkuQ7yD3FisTdKXpjHKsqh91ikayGiBQK4MecV5Yllqvz1Qhxzz3Bta6dpPsRrlE/07PnKr6sfl998Tt4jwdlAKfkTM0SIyrIve3iPhEldTcwYrQdHPrszwvOIboYQtNZJjrtWm+tH84juw7uVjl02j+Bi8+04mDJfd9msgvk4YLpKNi0RN1M2g1WwSmWZOTcIwsCqwSqYJEVwb3VwftomIdJls2tv9EU4NFXrCfuYT3s4Yif0OXWxnQS9db1FpXYNVsGmZVyyrRNR9/z0uMXPnSTpQ+Fg2OfstL2fldiBSFuWPfayPHuWHL83Kz2rBrJrCCrN/2zz3yZC0kjt574je+5aegMa2oNIBzU9D++0LZKAdROTOarrmzv7/Hyfp/VIkr9VopkJN2X93bA9VWhmfygu+65sxNOKdd22WNtsxMYS1IyUhRTY/pK0k+F1a4SFTHuYMxoVqwZnaa5tNbgsR5gDnEnOTtrLNpu70gEnmB9dl8EpWApKMCd4QHXZnIK5W+KxHDOGJ+qJ+2EywyFmjC+6jFcwVzNf+Sweyr2rCJqa1+uNi9LbTTPun5+0t/Pcgkrzb0q3bY1OkZCioAuVIMHcE/yhdI2jgLIQuh7iNvbdWm1rt2WydCnjk2+We/DBmHB7edcLAx9RML5ZLmPK69a7ybplcudL86eMMD3XprF/4nMo8ELbiIe8v9B2DAB5CIFu3pFYsGDBjPkLrs8PAOFwXg8AAAAASUVORK5CYII="},{name:m("addContact"),type:"addContact",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMMSURBVHgB7ZhBTxNBFMffm90S5GL9Bks8GE/ANygHoZqAI8XEG/UTIJ9A+gnATwDcPADZ6kHQA+Xk0d6MB5P9CPVSEdkZ3ywtqbi7zExna0j6S5p2O29m/zvz5s17CzBmzJiRguAAznn5LGZcIAvUNWPQOgr3W1AAQwlWQruCvaZhXqU0R1LKxqf3h7vgEA8sqXIenAvvM4mtZpiUEZHff/AQvn/7egqOYGCJEN4JfQU3W+LmwlKNgyOsXOLR0kqdZm/HoEtnisXTYRh20hrVaknp7YCU7eN3hxt5A1nNMGO4BmaUu7FXyWoUwq9LCRVJe+EJfz4LefcGQyq00dTgYAiiXh8BspzXbix4kmYL7AjAAT6MCsS7/Z89n92C3sNT+Av6bULIrcWntb6vR8fNg5eDw4xO8AAUYTbpKytyzJLLXfGY15ofwoOwf20d1oYBGba17JAOHyj9ZftfBB+H+9sU5u4xVppWH4qtb64aJTzr/38H47mj8G002NfYJc4opk6ABVL+GLzsxeTEVxeWVztKqYJ52LkuchDjGW5d3igCQ5DJEBxg6RK4B8ZMtLJaVHaXjEo+OwkXuf5tJficXWzTod7R74GNvGVWqajyaeWzWcf31UhgSZWvVihmntxoiND+2DyYA0dYRwk1K5KxObWMOWZ7UxjPg0OcVBxVvkLJC1uTvZMLpTylWBsWVXXcKoaeYVUmnUMpSLKsWATJnx6LLlv9KG+z2WAsWAn8Gft1YHIGkhz2xiysQ37eBoFN9Pxw2AfQFpxkWMJflyDrYJ9iqljbomqlYevfWoIXeW1dCtiEIYT+c2OEXcRSw3TGcwUnZXxSa4GzIvIaESU58yaic+NwV1XGxYlVBEL8/lLlLwLdDpmCF5ZXVEWQWxA6okyiT9Rq6hinClYbLONtTlEEXeFr3S9VsAS/SDdIBUFqrWa6YOEuGuhC8XxGxy5VMDKT1NENFJsjHbtUwb/gYtcs3x0eRKFVFKQKVmUQQ7kBo2PvKNR7LZt7cCTHMW3AIn26yJffY8aMccAfVaQNf36Q1l8AAAAASUVORK5CYII="},{name:m("createGroup"),type:"createGroup",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAPzSURBVHgB7ZnNThNRFMfPuVMSdFV37qzxE1mIbzAsgMZEHD5M3FGeAHgC6BNQnwDcmVjMVBZ8LVpXuqNuRI0kwxvAQiTA3Os5Qxs77XR6b5nihl9SZqZz586/956Pey4A11wTAqHHOI6TPvYtm8+FhYebbrECl6BngrOOk1HKWlEK7KZbnlIqv7P+YRW6wIIeMOK8GgKJn+n0ccTtNCI69x4NwP6PvU9gSOKCeWRJ7Aad3o5vifb9hwNH+z/3voABAhJGQcqhQ0arLeIi2zgYkLjgLbdYoF4nEMHTaJ7+46dyYEAKuiTrTNvkPDPkVEN8zQKlVCV2pm13zSXTqJLFlel+JrYjoZ6CAcZRIghT5P00905khwgVxL7ZTfedx/YslbVLbdtOOzlgZatUHAZNjE3iWFrldmIZDmNSnpX5h226rkeG+gYSxEjw6PjkIh2GNJpmjmVqnk9OxXmB5vEQEsJwhDGn31bN8ShXXPeQZqQECaEtmJ0MNMNVjfRvvy8wHXLOCiSEtmClZwohEFWGj5YlvPYdq69ggL5gCUYBniHBdzq2EeiCAYknDhM4dpuu3v6fYIocFK+142+d3gpWcBT5PYlVKIY5uYAh+jaspAeGKMBQ/KW06tHf/E307+6476vQBfprCcuqgpRgghBQ4WPNThMpFow6GXs5VY6oIKI7JofaKq3d5fPntKCXoBqiTMrrxhyCJ00a00IlT0nA1mur8nzkBdC5lLvhu2eU5qfI6YBmDUtopVzdH2BUcfz6/s2792iQZ8WOb4l5Gt0Cn1H7ZYhOOv3AmRMhS/4xf//xE/vBwOABvyO2Z+iCrDOZUwoXW9a6HKokiV0vBmLHnKk5SjgFg67ZlFZvoL/g8hokKcF1gkV8bfSoo2o/nFfrL8o6r6lqPl/RNaEmPCH6IsNez/clgqIUhB05I/F4N4X/rHmkjQTzcvEEUkPKp1G9KG3Stc8/FFYpAB+gBdXmtNvWlNpA5uGSL0yEvtN5sKF+c1oExuPVSqZ8fXprZdNyXNXSCI3yrcZRxnihbXdvjGFnahQ+Oj69RNOx2Ok5iyrwDSpq69dtUzN7uJTWbhJiGeonx7UeJxG+3v5YXKLDWzAkUjDXbrVwZLwG7kCQRLITUzN8cSr8+U77Fwr6QmuOFsEjLyZzNIFL0EOkDwUeaa73KHvOtm+J+ebQ1iKYOuhoVwmQ9pXkDHixMEKs8kqu/gmuFS7UzCasr/GCowHt3pThimiOADqERlj6KmmbjeUE+o3fFxLMO+RwhfTDifH7QoLZnjR3HS8NonBNzYFpcTqJYqLXorl/RGsBuiAy0wU7lGDZohc2TZsql/3HzDXXNPAXbzqhRgPhebEAAAAASUVORK5CYII="}],c=g((()=>{r.value=f.appUserStore.getSelfUserInfo()})),u=e=>{switch(e.type){case"newConversation":uni.navigateTo({url:"/ChatUIKIT/modules/ChatNew/index"});break;case"createGroup":uni.navigateTo({url:"/ChatUIKIT/modules/GroupCreate/index"});break;case"addContact":uni.navigateTo({url:"/ChatUIKIT/modules/ContactAdd/index"})}};return C((()=>{c()})),(e,c)=>{const v=p;return a(),n(v,null,{default:t((()=>[s(K,{showBackArrow:!1},{left:t((()=>[s(k,{size:32,src:r.value.avatar,withPresence:!0,placeholder:A(w),presenceExt:r.value.presenceExt,isOnline:r.value.isOnline},null,8,["src","placeholder","presenceExt","isOnline"])])),center:t((()=>[s(v,{class:"title"})])),right:t((()=>[s(v,{class:"btn-wrap"},{default:t((()=>[s(v,{class:"action-btn",onClick:c[0]||(c[0]=e=>o.value=!0)})])),_:1})])),_:1}),o.value?(a(),n(U,{key:0,options:i,popStyle:A(l),onOnMenuTap:u,onOnMenuClose:c[1]||(c[1]=e=>o.value=!1)},null,8,["popStyle"])):h("",!0)])),_:1})}}}),[["__scopeId","data-v-6fed5c68"]]),L=E(e({__name:"index",props:{conversation:{},showMenu:{type:Boolean}},emits:["mute","pin","delete","leftSwipe"],setup(e,{emit:I}){const N=e,K=I;let E=0;const Y=f.appUserStore,X=f.groupStore,U=d({}),M=d(!1),L=d(!1),Q=f.getFeatureConfig(),O=S((()=>{let e=[];return Q.muteConversation&&e.push({name:M.value?m("unmute"):m("mute"),action:"mute",class:"mute"}),Q.pinConversation&&e.push({name:N.conversation.isPinned?m("unpin"):m("pin"),action:"pin",class:"pin"}),Q.deleteConversation&&e.push({name:m("deleteConv"),action:"delete",class:"delete"}),e})),R=d([{name:m("confirmDeleteConv"),action:"confirmDelete",class:"confirm-delete"}]),V=S((()=>L.value?R.value:O.value)),F=g((()=>{M.value=f.convStore.getConversationMuteStatus(N.conversation.conversationId)})),W=g((()=>{const e=N.conversation.conversationId;if("groupChat"!==N.conversation.conversationType)return U.value=Y.getUserInfoFromStore(e);{const a=X.getGroupInfoFromStore(e);U.value={name:(null==a?void 0:a.groupName)||e,avatar:f.groupStore.getGroupAvatar(e)}}})),{getConversationTime:j}=f.convStore,G=()=>{if(N.showMenu)return L.value=!1,void K("leftSwipe",null);uni.navigateTo({url:`/ChatUIKIT/modules/Chat/index?type=${N.conversation.conversationType}&id=${N.conversation.conversationId}`})},J=e=>{E=e.touches[0].pageX},b=e=>{if(0===O.value.length)return;const a=e.touches[0].pageX-E;Math.abs(a)<60||(a>0?(K("leftSwipe",null),L.value=!1):K("leftSwipe",N.conversation.conversationId))};return C((()=>{W(),F()})),(e,d)=>{const g=p,f=v;return a(),n(g,{class:"swipe-menu-wrap",onTouchmove:b,onTouchstart:J,style:o({transform:`translateX(${N.showMenu?-272:0}px)`})},{default:t((()=>[s(g,{class:x(["conversation-item-wrap",{"pin-conversation-item-wrap":N.conversation.isPinned}]),onClick:G},{default:t((()=>[s(g,{class:"avatar-wrap"},{default:t((()=>[s(k,{src:U.value.avatar,placeholder:"groupChat"===N.conversation.conversationType?B:w},null,8,["src","placeholder"])])),_:1}),s(g,{class:"content-wrap"},{default:t((()=>[s(g,{class:"user-info-wrap"},{default:t((()=>[s(g,{class:"info-wrap"},{default:t((()=>[s(g,{class:"user-nick-name ellipsis"},{default:t((()=>[c(u(U.value.name),1)])),_:1}),M.value?(a(),n(f,{key:0,style:{width:"20px",height:"20px"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJXSURBVHgB7ZhdUtswEMdXknmuewPfoL1B2xtwgiSeKfQtwSdIcgIH0plOAzNO6AEKJ4AjwAngCPCOJFZOGBhGtlax7Acm/yeNbK9+Xn3tLsBOH1wMAikvilgoMTZtyeU0S9MHCKAIAolLPtFaj8q25ubHjyCAggGChvilyYB9on72+2zVlxpmjLGL4c9e+v45hwAy04sDvEIpiE2f67sN3BKbsQb93fbO1mvQAERP0cgYrjKOumGaHcs9eY1r8h7scKWUVml2mC6DAM7P/u2jwQKbTi9tRrlnik2Hh72lD5yR9xTPT1djNPifDGekIZFMJ75wRl4eLOEAJuAp/GaaHfQnvnBegPmfIuERvwNPNYEzIk+x2Fsfwl3CkQGN9/AQHoCHXHCUY4gMKCLYBw+54Ey/uXkotmhTzMQ3IIoCV/YrSCj2aICadqSQ4dYjf6HYJAHi+ktc73jBeSjIXdwWXBDANuEaA7YN1wiwC7itAbuC2wqwSzgjZ7DwNkgIDaci9dmVXDk9GEW83wZcOfgTdyZWtR7MF8VXzvgVwh23NK0PaOMH2ripeqHSg/PFatQynFFsxjj5e17pSasHTxbnA8100eWGwJwlG/7qzd73Wz2IWdq4692qxTrpJwEqBqsu4daE9vCrcpPURMKJkP7hv0tSy9vsIJ2RAJvkEKFlrc1IhanlBr0OrqxoSZFDjaSQWZNKl714xOES10Qf4TKX5zCYNfmKPeLGikLTMlzj+mB+Whxx4FYvKsAftKwrHwUpYJY3DueDl7IbHlOP6P0LhLuGnXaq1zNn5U+xxF6QfgAAAABJRU5ErkJggg=="})):h("",!0)])),_:1}),s(g,{class:"msg-wrap"},{default:t((()=>{var s;return[e.conversation.atType&&"NONE"!==e.conversation.atType?(a(),n(g,{key:0,class:"mention-tag"},{default:t((()=>[c(u("ALL"===e.conversation.atType?A(m)("atAllTag"):A(m)("atTag")),1)])),_:1})):h("",!0),"txt"===(null==(s=e.conversation.lastMessage)?void 0:s.type)?(a(),n(g,{key:1,class:"last-msg ellipsis"},{default:t((()=>[(a(!0),l(r,null,i(A(y)(e.conversation.lastMessage.msg),((e,t)=>(a(),l("span",{class:x([{"emoji-wrap":"text"!==e.type}]),key:t},["text"===e.type?(a(),l("span",{key:0},u(e.value),1)):(a(),n(f,{key:1,class:"msg-emoji",src:e.value},null,8,["src"]))],2)))),128))])),_:1})):(a(),n(g,{key:2,class:"last-msg ellipsis"},{default:t((()=>{return[c(u((a=e.conversation,T(a.lastMessage))),1)];var a})),_:1}))]})),_:1})])),_:1}),s(g,{class:"msg-right-wrap"},{default:t((()=>[s(g,{class:"time"},{default:t((()=>[c(u(A(j)(e.conversation.lastMessage)),1)])),_:1}),s(g,{class:x(e.conversation.unReadCount?"":"hidden")},{default:t((()=>[M.value?(a(),n(g,{key:0,class:"unread-mute"})):(a(),n(g,{key:1,class:"unread-count"},{default:t((()=>[c(u(e.conversation.unReadCount>99?"99+":e.conversation.unReadCount),1)])),_:1}))])),_:1},8,["class"])])),_:1})])),_:1})])),_:1},8,["class"]),s(g,{class:"menu-wrap"},{default:t((()=>[(a(!0),l(r,null,i(V.value,(e=>(a(),n(g,{class:x(["menu",e.class]),key:e.action,onClick:a=>(e=>{if("mute"===e)K("mute",N.conversation);else if("pin"===e)K("pin",N.conversation);else{if("delete"===e)return void(L.value=!0);"confirmDelete"===e&&K("delete",N.conversation)}K("leftSwipe",null),L.value=!1})(e.action)},{default:t((()=>[c(u(e.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1},8,["style"])}}}),[["__scopeId","data-v-30159d4c"]]),Q=E(e({__name:"index",setup(e){const o=d(null),c=d([]),u=d({}),v=g((()=>{c.value=N(f.convStore.conversationList)})),m=g((()=>{u.value=f.appUserStore.getSelfUserInfo()})),w=e=>{f.convStore.deleteConversation(e)},S=e=>{f.convStore.pinConversation(e,!e.isPinned)},y=e=>{f.convStore.getConversationMuteStatus(e.conversationId)?(e=>{f.convStore.clearRemindTypeForConversation(e)})(e):(e=>{f.convStore.setSilentModeForConversation(e)})(e)},B=e=>{o.value=e},T=()=>{uni.navigateTo({url:"/ChatUIKIT/modules/ConversationSearchList/index"})};return C((()=>{v(),m()})),(e,u)=>{const v=p;return a(),n(v,{class:"conversation-list-wrap"},{default:t((()=>[s(v,null,{default:t((()=>[s(v,{class:"header-wrap"},{default:t((()=>[s(M),s(Y,{class:"convs-search-btn",onClick:T})])),_:1}),s(v,{class:x(A(I)?"wx-block":"block")},null,8,["class"]),c.value.length?(a(),n(v,{key:0,class:"convs-wrap"},{default:t((()=>[(a(!0),l(r,null,i(c.value,(e=>(a(),n(v,{key:e.conversationId,"data-id":e.conversationId},{default:t((()=>[s(L,{conversation:e,showMenu:!!o.value&&o.value===e.conversationId,onMute:y,onPin:S,onDelete:w,onLeftSwipe:B},null,8,["conversation","showMenu"])])),_:2},1032,["data-id"])))),128))])),_:1})):h("",!0)])),_:1}),c.value.length?h("",!0):(a(),n(X,{key:0}))])),_:1})}}}),[["__scopeId","data-v-8d8dab3b"]]),O=E(e({__name:"index",setup(e){const t=d(""),s=g((()=>{t.value=f.chatStore.connState,console.log("IM Connection State: ",t.value)}));return C((()=>{s()})),(e,t)=>(a(),n(Q))}}),[["__scopeId","data-v-ac263487"]]);export{O as default};
